var fs=Object.defineProperty;var ps=(te,He,lt)=>He in te?fs(te,He,{enumerable:!0,configurable:!0,writable:!0,value:lt}):te[He]=lt;var Xt=(te,He,lt)=>ps(te,typeof He!="symbol"?He+"":He,lt);(function(){"use strict";function te(){}function He(t){return t()}function lt(){return Object.create(null)}function Me(t){t.forEach(He)}function $t(t){return typeof t=="function"}function nt(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let It;function Lt(t,e){return t===e?!0:(It||(It=document.createElement("a")),It.href=e,t===It.href)}function Yl(t){return Object.keys(t).length===0}function Gl(t,...e){if(t==null){for(const n of e)n(void 0);return te}const l=t.subscribe(...e);return l.unsubscribe?()=>l.unsubscribe():l}function ft(t,e,l){t.$$.on_destroy.push(Gl(e,l))}function De(t){return t??""}function ql(t,e,l){return t.set(l),e}function s(t,e){t.appendChild(e)}function R(t,e,l){t.insertBefore(e,l||null)}function F(t){t.parentNode&&t.parentNode.removeChild(t)}function el(t,e){for(let l=0;l<t.length;l+=1)t[l]&&t[l].d(e)}function a(t){return document.createElement(t)}function fe(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function O(t){return document.createTextNode(t)}function _(){return O(" ")}function Tt(){return O("")}function $(t,e,l,n){return t.addEventListener(e,l,n),()=>t.removeEventListener(e,l,n)}function Zl(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function Kl(t){return function(e){e.target===this&&t.call(this,e)}}function i(t,e,l){l==null?t.removeAttribute(e):t.getAttribute(e)!==l&&t.setAttribute(e,l)}function st(t){return t===""?null:+t}function Ql(t){return Array.from(t.childNodes)}function ie(t,e){e=""+e,t.data!==e&&(t.data=e)}function Ue(t,e){t.value=e??""}function tl(t,e,l,n){l==null?t.style.removeProperty(e):t.style.setProperty(e,l,"")}function ll(t,e,l){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e){o.selected=!0;return}}(!l||e!==void 0)&&(t.selectedIndex=-1)}function Xl(t){const e=t.querySelector(":checked");return e&&e.__value}function $l(t,e,{bubbles:l=!1,cancelable:n=!1}={}){return new CustomEvent(t,{detail:e,bubbles:l,cancelable:n})}let Mt;function At(t){Mt=t}function Nt(){if(!Mt)throw new Error("Function called outside component initialization");return Mt}function nl(t){Nt().$$.on_mount.push(t)}function en(t){Nt().$$.on_destroy.push(t)}function Bt(){const t=Nt();return(e,l,{cancelable:n=!1}={})=>{const o=t.$$.callbacks[e];if(o){const c=$l(e,l,{cancelable:n});return o.slice().forEach(r=>{r.call(t,c)}),!c.defaultPrevented}return!0}}const pt=[],it=[];let mt=[];const Vt=[],tn=Promise.resolve();let Ot=!1;function ln(){Ot||(Ot=!0,tn.then(sl))}function Ft(t){mt.push(t)}function nn(t){Vt.push(t)}const Jt=new Set;let ht=0;function sl(){if(ht!==0)return;const t=Mt;do{try{for(;ht<pt.length;){const e=pt[ht];ht++,At(e),sn(e.$$)}}catch(e){throw pt.length=0,ht=0,e}for(At(null),pt.length=0,ht=0;it.length;)it.pop()();for(let e=0;e<mt.length;e+=1){const l=mt[e];Jt.has(l)||(Jt.add(l),l())}mt.length=0}while(pt.length);for(;Vt.length;)Vt.pop()();Ot=!1,Jt.clear(),At(t)}function sn(t){if(t.fragment!==null){t.update(),Me(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ft)}}function on(t){const e=[],l=[];mt.forEach(n=>t.indexOf(n)===-1?e.push(n):l.push(n)),l.forEach(n=>n()),mt=e}const Rt=new Set;let ot;function il(){ot={r:0,c:[],p:ot}}function ol(){ot.r||Me(ot.c),ot=ot.p}function Ne(t,e){t&&t.i&&(Rt.delete(t),t.i(e))}function We(t,e,l,n){if(t&&t.o){if(Rt.has(t))return;Rt.add(t),ot.c.push(()=>{Rt.delete(t),n&&(l&&t.d(1),n())}),t.o(e)}else n&&n()}function Ht(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function an(t,e,l){const n=t.$$.props[e];n!==void 0&&(t.$$.bound[n]=l,l(t.$$.ctx[n]))}function Et(t){t&&t.c()}function gt(t,e,l){const{fragment:n,after_update:o}=t.$$;n&&n.m(e,l),Ft(()=>{const c=t.$$.on_mount.map(He).filter($t);t.$$.on_destroy?t.$$.on_destroy.push(...c):Me(c),t.$$.on_mount=[]}),o.forEach(Ft)}function bt(t,e){const l=t.$$;l.fragment!==null&&(on(l.after_update),Me(l.on_destroy),l.fragment&&l.fragment.d(e),l.on_destroy=l.fragment=null,l.ctx=[])}function rn(t,e){t.$$.dirty[0]===-1&&(pt.push(t),ln(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function _t(t,e,l,n,o,c,r=null,f=[-1]){const d=Mt;At(t);const u=t.$$={fragment:null,ctx:[],props:c,update:te,not_equal:o,bound:lt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:lt(),dirty:f,skip_bound:!1,root:e.target||d.$$.root};r&&r(u.root);let h=!1;if(u.ctx=l?l(t,e.props||{},(p,m,...y)=>{const g=y.length?y[0]:m;return u.ctx&&o(u.ctx[p],u.ctx[p]=g)&&(!u.skip_bound&&u.bound[p]&&u.bound[p](g),h&&rn(t,p)),m}):[],u.update(),h=!0,Me(u.before_update),u.fragment=n?n(u.ctx):!1,e.target){if(e.hydrate){const p=Ql(e.target);u.fragment&&u.fragment.l(p),p.forEach(F)}else u.fragment&&u.fragment.c();e.intro&&Ne(t.$$.fragment),gt(t,e.target,e.anchor),sl()}At(d)}class vt{constructor(){Xt(this,"$$");Xt(this,"$$set")}$destroy(){bt(this,1),this.$destroy=te}$on(e,l){if(!$t(l))return te;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(l),()=>{const o=n.indexOf(l);o!==-1&&n.splice(o,1)}}$set(e){this.$$set&&!Yl(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const cn="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(cn);const wt=[];function al(t,e=te){let l;const n=new Set;function o(f){if(nt(t,f)&&(t=f,l)){const d=!wt.length;for(const u of n)u[1](),wt.push(u,t);if(d){for(let u=0;u<wt.length;u+=2)wt[u][0](wt[u+1]);wt.length=0}}}function c(f){o(f(t))}function r(f,d=te){const u=[f,d];return n.add(u),n.size===1&&(l=e(o,c)||te),f(t),()=>{n.delete(u),n.size===0&&l&&(l(),l=null)}}return{set:o,update:c,subscribe:r}}const de=al({isAnalyzing:!1,isRecording:!1,isCalibrating:!1,isPaused:!1,isCameraPreview:!1,previewStream:null,inputMode:"none",videoFrame:null,realtimeData:{},trajectoryData:[],velocityData:[],localVideoUrl:null});function rl(t){de.update(e=>({...e,videoFrame:t}))}function dn(t,e,l){de.update(n=>({...n,realtimeData:t,trajectoryData:e||n.trajectoryData,velocityData:l||n.velocityData}))}function un(t){de.update(e=>({...e,localVideoUrl:t}))}function Ut(t){de.update(e=>({...e,isCameraPreview:!!t}))}function fn(t){de.update(e=>({...e,previewStream:t||null}))}function Wt(){de.update(t=>({...t,previewStream:null}))}function Yt(t){de.update(e=>({...e,inputMode:t==="upload"||t==="camera"?t:"none"}))}const xt=al({jumps:[],currentJumpIndex:0,selectedJumpIds:[]});function pn(t){xt.update(e=>{const l={...t,id:e.jumps.length+1,timestamp:Date.now()},n=[...e.jumps,l],o=t.jump_detected?[...e.selectedJumpIds,l.id]:e.selectedJumpIds;return{jumps:n,currentJumpIndex:n.length-1,selectedJumpIds:o}})}const Be=()=>typeof window<"u"&&window.BACKEND_URL?window.BACKEND_URL:"http://localhost:5000",mn=Be();async function we(t,e={}){const l=`${mn}${t}`,n=await fetch(l,e);try{return await n.json()}catch{return{}}}const Ae={setCamera(t){return we("/api/settings/camera",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({index:Number(t)})})},setFps(t){return we("/api/settings/fps",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fps:t})})},setHeight(t){return we("/api/settings/height",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({height:t})})},setMass(t){return we("/api/settings/mass",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mass:t})})},startRecording(){return we("/api/recording/start",{method:"POST"})},stopRecording(){return we("/api/recording/stop",{method:"POST"})},startCalibration(){return we("/api/calibration/start",{method:"POST"})},calibrationStatus(){return we("/api/calibration/status")},startAnalysis(){return we("/api/analysis/start",{method:"POST"})},analysisStatus(){return we("/api/analysis/status")},analysisResults(){return we("/api/analysis/results")},pauseAnalysis(){return we("/api/analysis/pause",{method:"POST"})},resumeAnalysis(){return we("/api/analysis/resume",{method:"POST"})},stopAnalysis(){return we("/api/analysis/stop",{method:"POST"})},videoFrame(){return we("/api/video/frame")},analysisData(){return we("/api/analysis/data")},async getPlayerData(t,e){var l;try{document.cookie=`session_id=${e}; path=/api/players`;const n=await fetch(`http://localhost:5173/api/players/${t}`,{method:"GET",credentials:"include",headers:{Accept:"*/*"}});if(!n.ok)return{success:!1,error:`Errore HTTP: ${n.status}`};const o=await n.json();return(l=o==null?void 0:o.data)!=null&&l.info?{success:!0,data:{height_cm:o.data.info.height_cm,weight_kg:o.data.info.weight_kg,name:o.data.info.name,surname:o.data.info.surname,position:o.data.info.position}}:{success:!1,error:"Dati giocatore non validi"}}catch(n){return{success:!1,error:`Errore di connessione: ${n.message}`}}}};function hn(t){let e;return{c(){e=O("SOURCE MEDIA")},m(l,n){R(l,e,n)},d(l){l&&F(e)}}}function gn(t){let e;return{c(){e=O("LIVE PREVIEW")},m(l,n){R(l,e,n)},d(l){l&&F(e)}}}function bn(t){let e;return{c(){e=O("VIDEO ANALYZED")},m(l,n){R(l,e,n)},d(l){l&&F(e)}}}function _n(t){let e;return{c(){e=a("div"),e.innerHTML='<svg class="w-16 h-16 mx-auto text-slate-600 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg> <p class="text-slate-400 text-sm">Nessun video caricato</p>',i(e,"class","text-center p-8 opacity-50")},m(l,n){R(l,e,n)},p:te,d(l){l&&F(e)}}}function vn(t){let e,l,n,o,c,r=t[4].isRecording&&cl(),f=t[4].isAnalyzing&&dl();return{c(){e=a("img"),n=_(),r&&r.c(),o=_(),f&&f.c(),c=Tt(),Lt(e.src,l=t[6])||i(e,"src",l),i(e,"alt","Video frame"),i(e,"class","w-full h-full object-contain")},m(d,u){R(d,e,u),R(d,n,u),r&&r.m(d,u),R(d,o,u),f&&f.m(d,u),R(d,c,u)},p(d,u){u&64&&!Lt(e.src,l=d[6])&&i(e,"src",l),d[4].isRecording?r||(r=cl(),r.c(),r.m(o.parentNode,o)):r&&(r.d(1),r=null),d[4].isAnalyzing?f||(f=dl(),f.c(),f.m(c.parentNode,c)):f&&(f.d(1),f=null)},d(d){d&&(F(e),F(n),F(o),F(c)),r&&r.d(d),f&&f.d(d)}}}function wn(t){let e,l;return{c(){e=a("video"),Lt(e.src,l=t[4].localVideoUrl)||i(e,"src",l),e.controls=!0,i(e,"class","w-full h-full object-contain")},m(n,o){R(n,e,o),t[10](e)},p(n,o){o&16&&!Lt(e.src,l=n[4].localVideoUrl)&&i(e,"src",l)},d(n){n&&F(e),t[10](null)}}}function xn(t){let e;return{c(){e=a("video"),e.autoplay=!0,e.playsInline=!0,e.muted=!0,i(e,"class","w-full h-full object-contain")},m(l,n){R(l,e,n),t[9](e)},p:te,d(l){l&&F(e),t[9](null)}}}function cl(t){let e;return{c(){e=a("div"),e.innerHTML='<div class="w-2 h-2 bg-white rounded-full"></div><span class="text-white text-xs font-bold">REC</span>',i(e,"class","absolute top-4 right-4 flex items-center gap-2 bg-red-600 px-3 py-1 rounded-full shadow-lg animate-pulse")},m(l,n){R(l,e,n)},d(l){l&&F(e)}}}function dl(t){let e;return{c(){e=a("div"),e.innerHTML='<span class="text-white text-xs font-bold">ANALYZING...</span>',i(e,"class","absolute bottom-4 left-4 bg-green-600/90 backdrop-blur px-3 py-1 rounded-lg border border-green-500/50")},m(l,n){R(l,e,n)},d(l){l&&F(e)}}}function ul(t){let e,l,n,o,c,r,f,d,u,h,p,m,y,g;return{c(){e=a("div"),l=a("div"),n=a("div"),o=a("span"),c=O("Frame "),r=O(t[2]),f=_(),d=a("span"),u=O(t[1]),h=_(),p=a("input"),i(n,"class","flex justify-between text-[10px] font-mono text-slate-400 px-0.5"),i(p,"type","range"),i(p,"min","0"),i(p,"max",m=Math.max(t[1]-1,0)),i(p,"class","w-full h-1.5 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-indigo-500"),i(l,"class","flex-1 flex flex-col gap-1.5 justify-center"),i(e,"class","h-16 bg-slate-900/95 border-t border-slate-800/80 backdrop-blur-sm px-6 flex items-center gap-6 shrink-0")},m(C,b){R(C,e,b),s(e,l),s(l,n),s(n,o),s(o,c),s(o,r),s(n,f),s(n,d),s(d,u),s(l,h),s(l,p),Ue(p,t[2]),y||(g=[$(p,"change",t[11]),$(p,"input",t[11]),$(p,"input",t[12])],y=!0)},p(C,b){b&4&&ie(r,C[2]),b&2&&ie(u,C[1]),b&2&&m!==(m=Math.max(C[1]-1,0))&&i(p,"max",m),b&4&&Ue(p,C[2])},d(C){C&&F(e),y=!1,Me(g)}}}function yn(t){let e,l,n,o,c,r,f,d,u;function h(v,S){return v[0]?bn:v[4].isCameraPreview?gn:hn}let p=h(t),m=p(t);function y(v,S){return v[4].isCameraPreview&&v[4].previewStream?xn:v[4].localVideoUrl&&!v[4].isAnalyzing&&!v[4].isRecording?wn:v[6]?vn:_n}let g=y(t),C=g(t),b=t[0]&&!t[4].localVideoUrl&&t[1]>0&&ul(t);return{c(){e=a("div"),l=a("div"),n=a("div"),o=a("span"),o.textContent="Analisi Biomeccanica",c=_(),r=a("span"),m.c(),f=_(),d=a("div"),C.c(),u=_(),b&&b.c(),i(o,"class","text-white font-medium text-sm drop-shadow-md"),i(r,"class","text-[10px] font-mono text-slate-300 opacity-80"),i(n,"class","flex flex-col"),i(l,"class","absolute top-0 left-0 right-0 p-4 z-10 bg-gradient-to-b from-black/90 via-black/40 to-transparent flex justify-between items-start pointer-events-none"),i(d,"class","flex-1 bg-black flex items-center justify-center relative overflow-hidden"),i(e,"class","bg-black rounded-2xl overflow-hidden border border-slate-800 relative shadow-2xl ring-1 ring-white/5 group h-full flex flex-col")},m(v,S){R(v,e,S),s(e,l),s(l,n),s(n,o),s(n,c),s(n,r),m.m(r,null),s(e,f),s(e,d),C.m(d,null),s(e,u),b&&b.m(e,null),t[13](e)},p(v,[S]){p!==(p=h(v))&&(m.d(1),m=p(v),m&&(m.c(),m.m(r,null))),g===(g=y(v))&&C?C.p(v,S):(C.d(1),C=g(v),C&&(C.c(),C.m(d,null))),v[0]&&!v[4].localVideoUrl&&v[1]>0?b?b.p(v,S):(b=ul(v),b.c(),b.m(e,null)):b&&(b.d(1),b=null)},i:te,o:te,d(v){v&&F(e),m.d(),C.d(),b&&b.d(),t[13](null)}}}function kn(t,e,l){let n,o;ft(t,de,w=>l(4,o=w));let{analysisCompleted:c=!1}=e,r=0,f=0,d=!1,u="",h,p,m;async function y(){try{const P=await(await fetch(`${Be()}/api/video/info`)).json();P&&P.success&&(l(1,r=P.total_frames||0),l(8,d=!0))}catch{}}async function g(w){try{const M=await(await fetch(`${Be()}/api/video/frame_at?index=${w}`)).json();M&&M.success?(l(2,f=M.index),rl(M.frame)):M&&M.error&&(u=M.error)}catch{u="Errore caricamento frame"}finally{}}function C(w){!c||r<=0||(h&&clearTimeout(h),h=setTimeout(()=>g(w),50))}nl(()=>{if(o.isCameraPreview&&o.previewStream&&m)try{l(3,m.srcObject=o.previewStream,m)}catch{}});function b(w){it[w?"unshift":"push"](()=>{m=w,l(3,m),l(4,o)})}function v(w){it[w?"unshift":"push"](()=>{m=w,l(3,m),l(4,o)})}function S(){f=st(this.value),l(2,f)}const k=w=>C(+w.target.value);function W(w){it[w?"unshift":"push"](()=>{p=w,l(5,p)})}return t.$$set=w=>{"analysisCompleted"in w&&l(0,c=w.analysisCompleted)},t.$$.update=()=>{if(t.$$.dirty&16&&l(6,n=o.videoFrame?`data:image/jpeg;base64,${o.videoFrame}`:null),t.$$.dirty&263&&c&&!d&&y().then(()=>{r>0&&g(f)}),t.$$.dirty&24&&o.isCameraPreview&&o.previewStream&&m)try{l(3,m.srcObject=o.previewStream,m)}catch{}},[c,r,f,m,o,p,n,C,d,b,v,S,k,W]}class Cn extends vt{constructor(e){super(),_t(this,e,kn,yn,nt,{analysisCompleted:0})}}async function jn(){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)throw new Error("API mediaDevices non disponibile");let t=null;try{t=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1})}catch{}try{return(await navigator.mediaDevices.enumerateDevices()).filter(n=>n.kind==="videoinput")}finally{if(t)try{t.getTracks().forEach(e=>e.stop())}catch{}}}async function Sn(t,e){const l=Array.isArray(e)?e:[],n=l[t]||l[0];return n&&n.deviceId?await navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:n.deviceId}},audio:!1}):await navigator.mediaDevices.getUserMedia({video:!0,audio:!1})}function Gt(t){var e;try{(e=t==null?void 0:t.getTracks())==null||e.forEach(l=>l.stop())}catch{}}function fl(t,e,l){const n=t.slice();return n[11]=e[l],n[13]=l,n}function pl(t){let e,l,n,o,c,r,f,d,u,h,p,m,y,g,C,b,v,S,k=t[4]&&ml(t);function W(M,q){return M[2]?An:M[3].length>0?Mn:Tn}let w=W(t),P=w(t);return{c(){e=a("div"),l=a("div"),n=a("div"),o=a("h4"),o.textContent="Seleziona fotocamera",c=_(),r=a("button"),r.innerHTML='<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',f=_(),d=a("div"),k&&k.c(),u=_(),P.c(),h=_(),p=a("div"),m=a("button"),m.textContent="Annulla",y=_(),g=a("button"),C=O("Conferma e anteprima"),i(o,"id","camera-modal-title"),i(o,"class","text-white font-semibold text-lg"),i(r,"class","text-slate-400 hover:text-white focus:text-white transition-colors focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 focus:ring-offset-slate-800 rounded p-1"),i(r,"aria-label","Chiudi modal"),i(n,"class","px-4 sm:px-6 py-3 sm:py-4 border-b border-slate-700 flex items-center justify-between"),i(d,"class","p-4 sm:p-6 space-y-4"),i(m,"class","btn-secondary"),i(m,"aria-label","Annulla selezione fotocamera"),i(g,"class","btn-primary"),g.disabled=b=t[2]||t[3].length===0,i(g,"aria-label","Conferma selezione e avvia anteprima"),i(p,"class","px-4 sm:px-6 py-3 sm:py-4 border-t border-slate-700 flex gap-2 sm:gap-3 justify-end"),i(l,"class","bg-slate-800 border border-slate-700 rounded-xl w-full max-w-md shadow-2xl"),i(l,"role","document"),i(e,"class","fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm p-4"),i(e,"role","dialog"),i(e,"aria-modal","true"),i(e,"aria-labelledby","camera-modal-title")},m(M,q){R(M,e,q),s(e,l),s(l,n),s(n,o),s(n,c),s(n,r),s(l,f),s(l,d),k&&k.m(d,null),s(d,u),P.m(d,null),s(l,h),s(l,p),s(p,m),s(p,y),s(p,g),s(g,C),v||(S=[$(r,"click",t[5]),$(m,"click",t[5]),$(g,"click",t[6]),$(e,"click",Kl(t[5])),$(e,"keydown",t[9])],v=!0)},p(M,q){M[4]?k?k.p(M,q):(k=ml(M),k.c(),k.m(d,u)):k&&(k.d(1),k=null),w===(w=W(M))&&P?P.p(M,q):(P.d(1),P=w(M),P&&(P.c(),P.m(d,null))),q&12&&b!==(b=M[2]||M[3].length===0)&&(g.disabled=b)},d(M){M&&F(e),k&&k.d(),P.d(),v=!1,Me(S)}}}function ml(t){let e,l;return{c(){e=a("div"),l=O(t[4]),i(e,"class","bg-red-500/10 border border-red-500/50 rounded-lg p-3 text-red-300 text-sm"),i(e,"role","alert")},m(n,o){R(n,e,o),s(e,l)},p(n,o){o&16&&ie(l,n[4])},d(n){n&&F(e)}}}function Tn(t){let e;return{c(){e=a("p"),e.textContent="Nessuna fotocamera disponibile.",i(e,"class","text-slate-400"),i(e,"role","status")},m(l,n){R(l,e,n)},p:te,d(l){l&&F(e)}}}function Mn(t){let e,l,n,o,c,r,f,d,u=Ht(t[3]),h=[];for(let p=0;p<u.length;p+=1)h[p]=hl(fl(t,u,p));return{c(){e=a("div"),l=a("label"),l.textContent="Fotocamera",n=_(),o=a("select");for(let p=0;p<h.length;p+=1)h[p].c();c=_(),r=a("p"),r.textContent="Seleziona una fotocamera dalla lista",i(l,"for","camera-select"),i(l,"class","block text-sm font-medium text-slate-300 mb-2"),i(o,"id","camera-select"),i(o,"class","input-field"),i(o,"aria-describedby","camera-select-help"),t[0]===void 0&&Ft(()=>t[8].call(o)),i(r,"id","camera-select-help"),i(r,"class","sr-only")},m(p,m){R(p,e,m),s(e,l),s(e,n),s(e,o);for(let y=0;y<h.length;y+=1)h[y]&&h[y].m(o,null);ll(o,t[0],!0),s(e,c),s(e,r),f||(d=[$(o,"change",t[7]),$(o,"change",t[8])],f=!0)},p(p,m){if(m&8){u=Ht(p[3]);let y;for(y=0;y<u.length;y+=1){const g=fl(p,u,y);h[y]?h[y].p(g,m):(h[y]=hl(g),h[y].c(),h[y].m(o,null))}for(;y<h.length;y+=1)h[y].d(1);h.length=u.length}m&1&&ll(o,p[0])},d(p){p&&F(e),el(h,p),f=!1,Me(d)}}}function An(t){let e;return{c(){e=a("div"),e.innerHTML='<svg class="animate-spin h-5 w-5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" aria-hidden="true"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> <p class="text-slate-300">Caricamento fotocamere...</p>',i(e,"class","flex items-center gap-3"),i(e,"role","status"),i(e,"aria-live","polite")},m(l,n){R(l,e,n)},p:te,d(l){l&&F(e)}}}function hl(t){let e,l=(t[11].label||`Camera ${t[13]+1}`)+"",n;return{c(){e=a("option"),n=O(l),e.__value=t[13],Ue(e,e.__value)},m(o,c){R(o,e,c),s(e,n)},p(o,c){c&8&&l!==(l=(o[11].label||`Camera ${o[13]+1}`)+"")&&ie(n,l)},d(o){o&&F(e)}}}function En(t){let e,l=t[1]&&pl(t);return{c(){l&&l.c(),e=Tt()},m(n,o){l&&l.m(n,o),R(n,e,o)},p(n,[o]){n[1]?l?l.p(n,o):(l=pl(n),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:te,o:te,d(n){n&&F(e),l&&l.d(n)}}}function zn(t,e,l){let{show:n=!1}=e,{loading:o=!1}=e,{cameras:c=[]}=e,{selectedIndex:r=null}=e,{error:f=""}=e;const d=Bt();function u(){d("close")}function h(){d("confirm")}function p(g){const C=Number(g.target.value);d("select",{index:C})}function m(){r=Xl(this),l(0,r)}const y=g=>g.key==="Escape"&&u();return t.$$set=g=>{"show"in g&&l(1,n=g.show),"loading"in g&&l(2,o=g.loading),"cameras"in g&&l(3,c=g.cameras),"selectedIndex"in g&&l(0,r=g.selectedIndex),"error"in g&&l(4,f=g.error)},[r,n,o,c,f,u,h,p,m,y]}class Pn extends vt{constructor(e){super(),_t(this,e,zn,En,nt,{show:1,loading:2,cameras:3,selectedIndex:0,error:4})}}function Dn(t){let e;return{c(){e=O("Elaborazione Analisi")},m(l,n){R(l,e,n)},d(l){l&&F(e)}}}function In(t){let e;return{c(){e=O("Calibrazione & Dati")},m(l,n){R(l,e,n)},d(l){l&&F(e)}}}function Ln(t){let e;return{c(){e=O("Acquisizione Video")},m(l,n){R(l,e,n)},d(l){l&&F(e)}}}function gl(t){let e,l,n;return{c(){e=a("button"),e.innerHTML='<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>',i(e,"class","text-slate-400 hover:text-white transition-colors p-2 rounded-lg hover:bg-slate-800"),i(e,"aria-label","Torna indietro")},m(o,c){R(o,e,c),l||(n=$(e,"click",t[24]),l=!0)},p:te,d(o){o&&F(e),l=!1,n()}}}function bl(t){let e,l,n,o,c,r,f,d;return{c(){e=a("div"),l=fe("svg"),n=fe("circle"),o=fe("line"),c=fe("line"),r=_(),f=a("p"),d=O(t[5]),i(n,"cx","12"),i(n,"cy","12"),i(n,"r","10"),i(o,"x1","12"),i(o,"y1","8"),i(o,"x2","12"),i(o,"y2","12"),i(c,"x1","12"),i(c,"y1","16"),i(c,"x2","12.01"),i(c,"y2","16"),i(l,"class","w-5 h-5 text-red-400 shrink-0 mt-0.5"),i(l,"fill","none"),i(l,"stroke","currentColor"),i(l,"viewBox","0 0 24 24"),i(f,"class","text-red-400 text-sm font-medium"),i(e,"class","bg-red-500/10 border border-red-500/20 rounded-lg p-3 flex items-start gap-3")},m(u,h){R(u,e,h),s(e,l),s(l,n),s(l,o),s(l,c),s(e,r),s(e,f),s(f,d)},p(u,h){h[0]&32&&ie(d,u[5])},d(u){u&&F(e)}}}function _l(t){let e,l,n=t[13].inputMode!=="camera"&&vl(t);function o(f,d){return f[13].isRecording?Bn:Fn}let c=o(t),r=c(t);return{c(){e=a("div"),n&&n.c(),l=_(),r.c(),i(e,"class","space-y-5 animate-in fade-in slide-in-from-right-2 duration-300")},m(f,d){R(f,e,d),n&&n.m(e,null),s(e,l),r.m(e,null)},p(f,d){f[13].inputMode!=="camera"?n?n.p(f,d):(n=vl(f),n.c(),n.m(e,l)):n&&(n.d(1),n=null),c===(c=o(f))&&r?r.p(f,d):(r.d(1),r=c(f),r&&(r.c(),r.m(e,null)))},d(f){f&&F(e),n&&n.d(),r.d()}}}function vl(t){let e,l,n,o,c,r,f,d,u,h=t[1]?"Caricamento in corso...":"Carica un file video",p,m,y,g,C,b,v,S;return{c(){e=a("div"),l=a("input"),o=_(),c=a("div"),r=a("div"),r.innerHTML='<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg>',f=_(),d=a("div"),u=a("p"),p=O(h),m=_(),y=a("p"),y.textContent="MP4, MOV, AVI fino a 50MB",C=_(),b=a("div"),b.innerHTML='<div class="grow border-t border-slate-700"></div> <span class="shrink-0 mx-4 text-xs text-slate-500 font-medium uppercase">Oppure</span> <div class="grow border-t border-slate-700"></div>',i(l,"type","file"),i(l,"accept","video/*"),l.disabled=n=t[1]||t[13].isRecording,i(l,"class","absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10 disabled:cursor-not-allowed"),i(r,"class","w-12 h-12 rounded-full bg-slate-700 group-hover:bg-indigo-600/20 group-hover:text-indigo-400 flex items-center justify-center transition-colors text-slate-400"),i(u,"class","text-sm font-semibold text-white group-hover:text-indigo-300 transition-colors"),i(y,"class","text-xs text-slate-500 mt-1"),i(c,"class",g="flex flex-col items-center gap-3 "+(t[1]?"opacity-50":"")),i(e,"class","bg-slate-800/50 border border-slate-700 border-dashed rounded-xl p-6 text-center hover:bg-slate-800 transition-colors group cursor-pointer relative"),i(b,"class","relative flex items-center py-2")},m(k,W){R(k,e,W),s(e,l),s(e,o),s(e,c),s(c,r),s(c,f),s(c,d),s(d,u),s(u,p),s(d,m),s(d,y),R(k,C,W),R(k,b,W),v||(S=$(l,"change",t[14]),v=!0)},p(k,W){W[0]&8194&&n!==(n=k[1]||k[13].isRecording)&&(l.disabled=n),W[0]&2&&h!==(h=k[1]?"Caricamento in corso...":"Carica un file video")&&ie(p,h),W[0]&2&&g!==(g="flex flex-col items-center gap-3 "+(k[1]?"opacity-50":""))&&i(c,"class",g)},d(k){k&&(F(e),F(C),F(b)),v=!1,S()}}}function Bn(t){let e,l,n,o,c,r,f,d,u,h;return{c(){e=a("div"),l=a("div"),l.innerHTML='<div class="w-4 h-4 bg-red-500 rounded animate-pulse"></div>',n=_(),o=a("h3"),o.textContent="Registrazione in corso",c=_(),r=a("p"),r.textContent="Esegui il salto ora...",f=_(),d=a("button"),d.innerHTML=`<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><rect x="6" y="6" width="12" height="12"></rect></svg>
                Termina Registrazione`,i(l,"class","w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4"),i(o,"class","text-white font-semibold mb-1"),i(r,"class","text-slate-400 text-xs mb-6"),i(d,"class","btn-danger w-full flex items-center justify-center gap-2 py-3"),i(e,"class","bg-red-900/20 border border-red-500/30 rounded-lg p-6 text-center animate-pulse-fade")},m(p,m){R(p,e,m),s(e,l),s(e,n),s(e,o),s(e,c),s(e,r),s(e,f),s(e,d),u||(h=$(d,"click",t[18]),u=!0)},p:te,d(p){p&&F(e),u=!1,h()}}}function Fn(t){let e,l,n,o,c=t[13].inputMode==="camera"?"Cambia Sorgente Video":"Usa Fotocamera",r,f,d,u,h,p=t[13].isCameraPreview&&wl(t);return{c(){e=a("button"),l=fe("svg"),n=fe("path"),o=_(),r=O(c),f=_(),p&&p.c(),d=Tt(),i(n,"stroke-linecap","round"),i(n,"stroke-linejoin","round"),i(n,"stroke-width","2"),i(n,"d","M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"),i(l,"class","w-5 h-5"),i(l,"fill","none"),i(l,"stroke","currentColor"),i(l,"viewBox","0 0 24 24"),i(e,"class","btn-secondary w-full flex items-center justify-center gap-2 py-3")},m(m,y){R(m,e,y),s(e,l),s(l,n),s(e,o),s(e,r),R(m,f,y),p&&p.m(m,y),R(m,d,y),u||(h=$(e,"click",t[15]),u=!0)},p(m,y){y[0]&8192&&c!==(c=m[13].inputMode==="camera"?"Cambia Sorgente Video":"Usa Fotocamera")&&ie(r,c),m[13].isCameraPreview?p?p.p(m,y):(p=wl(m),p.c(),p.m(d.parentNode,d)):p&&(p.d(1),p=null)},d(m){m&&(F(e),F(f),F(d)),p&&p.d(m),u=!1,h()}}}function wl(t){let e,l,n,o,c,r,f,d;return{c(){e=a("div"),l=a("div"),l.innerHTML='<div class="w-2 h-2 rounded-full bg-indigo-400 animate-pulse"></div> <h4 class="text-sm font-medium text-indigo-300">Anteprima Attiva</h4>',n=_(),o=a("p"),o.textContent="Posizionati correttamente nel riquadro. Quando sei pronto, avvia l'analisi.",c=_(),r=a("button"),r.innerHTML=`<div class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
                  REC &amp; Analizza`,i(l,"class","flex items-center gap-3 mb-3"),i(o,"class","text-xs text-indigo-200/70 mb-4 leading-relaxed"),i(r,"class","btn-primary w-full flex items-center justify-center gap-2 py-3 shadow-lg shadow-indigo-900/40"),i(e,"class","bg-indigo-900/20 border border-indigo-500/30 rounded-lg p-4 mt-4 animate-pulse-fade")},m(u,h){R(u,e,h),s(e,l),s(e,n),s(e,o),s(e,c),s(e,r),f||(d=$(r,"click",t[17]),f=!0)},p:te,d(u){u&&F(e),f=!1,d()}}}function xl(t){let e,l,n,o,c,r,f,d,u,h,p,m,y,g,C,b,v,S,k,W,w,P;function M(A,N){return A[6]?Hn:Rn}let q=M(t),D=q(t);return{c(){e=a("div"),l=a("div"),n=a("div"),o=a("label"),o.textContent="FPS Video",c=_(),r=a("div"),f=a("input"),d=_(),u=a("div"),u.innerHTML='<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>',h=_(),p=a("div"),m=a("label"),m.textContent="Altezza (cm)",y=_(),g=a("input"),C=_(),b=a("div"),v=a("label"),v.textContent="Massa (kg)",S=_(),k=a("input"),W=_(),D.c(),i(o,"for","fps-input"),i(o,"class","block text-xs font-medium text-slate-400 uppercase tracking-wide mb-1.5"),i(f,"id","fps-input"),i(f,"type","number"),i(f,"min","1"),i(f,"max","240"),f.disabled=t[6],i(f,"class","input-field pl-10 font-mono text-sm"),i(u,"class","absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"),i(r,"class","relative"),i(n,"class","col-span-2"),i(m,"for","height-input"),i(m,"class","block text-xs font-medium text-slate-400 uppercase tracking-wide mb-1.5"),i(g,"id","height-input"),i(g,"type","number"),i(g,"min","100"),i(g,"max","250"),g.disabled=t[6],i(g,"class","input-field font-mono text-sm"),i(v,"for","mass-input"),i(v,"class","block text-xs font-medium text-slate-400 uppercase tracking-wide mb-1.5"),i(k,"id","mass-input"),i(k,"type","number"),i(k,"min","40"),i(k,"max","150"),k.disabled=t[6],i(k,"class","input-field font-mono text-sm"),i(l,"class","grid grid-cols-2 gap-4"),i(e,"class","space-y-5 animate-in fade-in slide-in-from-right-2 duration-300")},m(A,N){R(A,e,N),s(e,l),s(l,n),s(n,o),s(n,c),s(n,r),s(r,f),Ue(f,t[2]),s(r,d),s(r,u),s(l,h),s(l,p),s(p,m),s(p,y),s(p,g),Ue(g,t[3]),s(l,C),s(l,b),s(b,v),s(b,S),s(b,k),Ue(k,t[4]),s(e,W),D.m(e,null),w||(P=[$(f,"input",t[28]),$(g,"input",t[29]),$(k,"input",t[30])],w=!0)},p(A,N){N[0]&64&&(f.disabled=A[6]),N[0]&4&&st(f.value)!==A[2]&&Ue(f,A[2]),N[0]&64&&(g.disabled=A[6]),N[0]&8&&st(g.value)!==A[3]&&Ue(g,A[3]),N[0]&64&&(k.disabled=A[6]),N[0]&16&&st(k.value)!==A[4]&&Ue(k,A[4]),q===(q=M(A))&&D?D.p(A,N):(D.d(1),D=q(A),D&&(D.c(),D.m(e,null)))},d(A){A&&F(e),D.d(),w=!1,Me(P)}}}function Rn(t){let e,l,n;return{c(){e=a("button"),e.innerHTML=`<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
            Conferma e Avvia`,i(e,"class","btn-primary w-full flex items-center justify-center gap-2 py-3 mt-2")},m(o,c){R(o,e,c),l||(n=$(e,"click",t[19]),l=!0)},p:te,d(o){o&&F(e),l=!1,n()}}}function Hn(t){let e;return{c(){e=a("div"),e.innerHTML='<svg class="animate-spin h-8 w-8 text-indigo-500 mb-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> <p class="text-indigo-300 text-sm font-medium">Calibrazione in corso...</p> <p class="text-indigo-400/60 text-xs mt-1">Mantieni il soggetto in posizione eretta</p>',i(e,"class","bg-indigo-900/20 border border-indigo-500/30 rounded-lg p-4 flex flex-col items-center text-center animate-pulse")},m(l,n){R(l,e,n)},p:te,d(l){l&&F(e)}}}function yl(t){var ne,z,Z,ue;let e,l,n,o,c,r,f,d,u,h,p,m,y=(((ne=t[13].realtimeData)==null?void 0:ne.current_height)??0)+"",g,C,b,v,S,k,W,w=(((z=t[13].realtimeData)==null?void 0:z.max_height)??0)+"",P,M,q,D,A,N,le,ae=(((Z=t[13].realtimeData)==null?void 0:Z.takeoff_velocity)??0)+"",ee,I,U,T,E,j,V=(((ue=t[13].realtimeData)==null?void 0:ue.estimated_power)??0)+"",J,Y,Q;function oe(G,se){return G[7]?Vn:Nn}let x=oe(t),H=x(t),L=t[7]&&kl(),B=t[7]&&Cl(t);return{c(){e=a("div"),H.c(),l=_(),n=a("div"),o=a("div"),c=a("h3"),c.textContent="Metriche Live",r=_(),L&&L.c(),f=_(),d=a("div"),u=a("div"),h=a("span"),h.textContent="Alt. Corrente",p=_(),m=a("span"),g=O(y),C=O(" cm"),b=_(),v=a("div"),S=a("span"),S.textContent="Alt. Max",k=_(),W=a("span"),P=O(w),M=O(" cm"),q=_(),D=a("div"),A=a("span"),A.textContent="Vel. Decollo",N=_(),le=a("span"),ee=O(ae),I=_(),U=a("div"),T=a("span"),T.textContent="Potenza",E=_(),j=a("span"),J=O(V),Y=O(" W"),Q=_(),B&&B.c(),i(c,"class","text-[10px] font-bold text-slate-400 uppercase tracking-wider flex items-center gap-2"),i(o,"class","px-4 py-2 border-b border-slate-700 bg-slate-800/50 flex justify-between items-center"),i(h,"class","text-[10px] text-slate-500 uppercase tracking-wide font-semibold mb-0.5"),i(m,"class","text-lg font-mono font-bold text-blue-400"),i(u,"class","flex flex-col"),i(S,"class","text-[10px] text-slate-500 uppercase tracking-wide font-semibold mb-0.5"),i(W,"class","text-lg font-mono font-bold text-emerald-400"),i(v,"class","flex flex-col"),i(A,"class","text-[10px] text-slate-500 uppercase tracking-wide font-semibold mb-0.5"),i(le,"class","text-lg font-mono font-bold text-purple-400"),i(D,"class","flex flex-col"),i(T,"class","text-[10px] text-slate-500 uppercase tracking-wide font-semibold mb-0.5"),i(j,"class","text-lg font-mono font-bold text-amber-400"),i(U,"class","flex flex-col"),i(d,"class","p-4 grid grid-cols-2 gap-4"),i(n,"class","bg-slate-800 rounded-lg border border-slate-700 overflow-hidden shadow-sm"),i(e,"class","space-y-5 animate-in fade-in slide-in-from-right-2 duration-300")},m(G,se){R(G,e,se),H.m(e,null),s(e,l),s(e,n),s(n,o),s(o,c),s(o,r),L&&L.m(o,null),s(n,f),s(n,d),s(d,u),s(u,h),s(u,p),s(u,m),s(m,g),s(m,C),s(d,b),s(d,v),s(v,S),s(v,k),s(v,W),s(W,P),s(W,M),s(d,q),s(d,D),s(D,A),s(D,N),s(D,le),s(le,ee),s(d,I),s(d,U),s(U,T),s(U,E),s(U,j),s(j,J),s(j,Y),s(e,Q),B&&B.m(e,null)},p(G,se){var pe,he,Ve,xe;x===(x=oe(G))&&H?H.p(G,se):(H.d(1),H=x(G),H&&(H.c(),H.m(e,l))),G[7]?L||(L=kl(),L.c(),L.m(o,null)):L&&(L.d(1),L=null),se[0]&8192&&y!==(y=(((pe=G[13].realtimeData)==null?void 0:pe.current_height)??0)+"")&&ie(g,y),se[0]&8192&&w!==(w=(((he=G[13].realtimeData)==null?void 0:he.max_height)??0)+"")&&ie(P,w),se[0]&8192&&ae!==(ae=(((Ve=G[13].realtimeData)==null?void 0:Ve.takeoff_velocity)??0)+"")&&ie(ee,ae),se[0]&8192&&V!==(V=(((xe=G[13].realtimeData)==null?void 0:xe.estimated_power)??0)+"")&&ie(J,V),G[7]?B?B.p(G,se):(B=Cl(G),B.c(),B.m(e,null)):B&&(B.d(1),B=null)},d(G){G&&F(e),H.d(),L&&L.d(),B&&B.d()}}}function Nn(t){let e,l,n;return{c(){e=a("button"),e.innerHTML=`<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                Riavvia Analisi`,i(e,"class","btn-primary w-full flex items-center justify-center gap-2 py-3")},m(o,c){R(o,e,c),l||(n=$(e,"click",t[20]),l=!0)},p:te,d(o){o&&F(e),l=!1,n()}}}function Vn(t){let e;return{c(){e=a("div"),e.innerHTML='<div class="relative flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-emerald-500"></span></div> <div><p class="text-emerald-400 text-sm font-medium">Elaborazione in corso...</p> <p class="text-emerald-500/60 text-xs">Analisi traiettoria e fasi</p></div>',i(e,"class","bg-emerald-900/20 border border-emerald-500/30 rounded-lg p-4 flex items-center gap-3 animate-pulse")},m(l,n){R(l,e,n)},p:te,d(l){l&&F(e)}}}function kl(t){let e;return{c(){e=a("div"),i(e,"class","w-1.5 h-1.5 rounded-full bg-red-500 animate-pulse")},m(l,n){R(l,e,n)},d(l){l&&F(e)}}}function Cl(t){let e,l,n,o,c;function r(u,h){return u[13].isPaused?Jn:On}let f=r(t),d=f(t);return{c(){e=a("div"),d.c(),l=_(),n=a("button"),n.textContent="Stop",i(n,"class","btn-danger text-xs py-2"),i(e,"class","grid grid-cols-2 gap-2 pt-2")},m(u,h){R(u,e,h),d.m(e,null),s(e,l),s(e,n),o||(c=$(n,"click",t[23]),o=!0)},p(u,h){f===(f=r(u))&&d?d.p(u,h):(d.d(1),d=f(u),d&&(d.c(),d.m(e,l)))},d(u){u&&F(e),d.d(),o=!1,c()}}}function On(t){let e,l,n;return{c(){e=a("button"),e.textContent="Pausa",i(e,"class","btn-secondary text-xs py-2")},m(o,c){R(o,e,c),l||(n=$(e,"click",t[21]),l=!0)},p:te,d(o){o&&F(e),l=!1,n()}}}function Jn(t){let e,l,n;return{c(){e=a("button"),e.textContent="Riprendi",i(e,"class","btn-secondary text-xs py-2")},m(o,c){R(o,e,c),l||(n=$(e,"click",t[22]),l=!0)},p:te,d(o){o&&F(e),l=!1,n()}}}function Un(t){let e,l,n,o,c,r,f,d,u,h,p,m,y,g,C,b,v,S,k,W,w,P,M;function q(E,j){return E[0]===1?Ln:E[0]===2?In:Dn}let D=q(t),A=D(t),N=(t[0]>1||t[13].isCameraPreview)&&gl(t);function le(E){t[25](E)}let ae={show:t[8],loading:t[11],cameras:t[9],error:t[12]};t[10]!==void 0&&(ae.selectedIndex=t[10]),v=new Pn({props:ae}),it.push(()=>an(v,"selectedIndex",le)),v.$on("close",t[26]),v.$on("confirm",t[16]),v.$on("select",t[27]);let ee=t[5]&&bl(t),I=t[0]===1&&_l(t),U=t[0]===2&&xl(t),T=t[0]===3&&yl(t);return{c(){e=a("div"),l=a("div"),n=a("div"),o=a("div"),c=a("h2"),r=a("span"),f=O(t[0]),d=O(`\r
            CONFIGURAZIONE`),u=_(),h=a("p"),A.c(),p=_(),N&&N.c(),m=_(),y=a("div"),g=a("div"),C=_(),b=a("div"),Et(v.$$.fragment),k=_(),ee&&ee.c(),W=_(),I&&I.c(),w=_(),U&&U.c(),P=_(),T&&T.c(),i(r,"class","bg-indigo-600 w-6 h-6 rounded flex items-center justify-center text-[10px]"),i(c,"class","text-sm font-bold text-white tracking-tight flex items-center gap-2"),i(h,"class","text-slate-500 text-xs mt-1 font-medium pl-8"),i(n,"class","px-5 py-4 flex justify-between items-center"),i(g,"class","h-full bg-indigo-500 transition-all duration-500 ease-out"),tl(g,"width",t[0]/3*100+"%"),i(y,"class","w-full h-1 bg-slate-800"),i(l,"class","shrink-0 bg-slate-900 z-10 border-b border-slate-800"),i(b,"class","flex-1 overflow-y-auto p-5 custom-scrollbar bg-slate-900/50 space-y-6"),i(e,"class","bg-slate-900 rounded-2xl border border-slate-800 shadow-xl overflow-hidden relative ring-1 ring-white/5 flex flex-col h-full w-full"),i(e,"role","region"),i(e,"aria-label","Pannello controllo analisi")},m(E,j){R(E,e,j),s(e,l),s(l,n),s(n,o),s(o,c),s(c,r),s(r,f),s(c,d),s(o,u),s(o,h),A.m(h,null),s(n,p),N&&N.m(n,null),s(l,m),s(l,y),s(y,g),s(e,C),s(e,b),gt(v,b,null),s(b,k),ee&&ee.m(b,null),s(b,W),I&&I.m(b,null),s(b,w),U&&U.m(b,null),s(b,P),T&&T.m(b,null),M=!0},p(E,j){(!M||j[0]&1)&&ie(f,E[0]),D!==(D=q(E))&&(A.d(1),A=D(E),A&&(A.c(),A.m(h,null))),E[0]>1||E[13].isCameraPreview?N?N.p(E,j):(N=gl(E),N.c(),N.m(n,null)):N&&(N.d(1),N=null),(!M||j[0]&1)&&tl(g,"width",E[0]/3*100+"%");const V={};j[0]&256&&(V.show=E[8]),j[0]&2048&&(V.loading=E[11]),j[0]&512&&(V.cameras=E[9]),j[0]&4096&&(V.error=E[12]),!S&&j[0]&1024&&(S=!0,V.selectedIndex=E[10],nn(()=>S=!1)),v.$set(V),E[5]?ee?ee.p(E,j):(ee=bl(E),ee.c(),ee.m(b,W)):ee&&(ee.d(1),ee=null),E[0]===1?I?I.p(E,j):(I=_l(E),I.c(),I.m(b,w)):I&&(I.d(1),I=null),E[0]===2?U?U.p(E,j):(U=xl(E),U.c(),U.m(b,P)):U&&(U.d(1),U=null),E[0]===3?T?T.p(E,j):(T=yl(E),T.c(),T.m(b,null)):T&&(T.d(1),T=null)},i(E){M||(Ne(v.$$.fragment,E),M=!0)},o(E){We(v.$$.fragment,E),M=!1},d(E){E&&F(e),A.d(),N&&N.d(),bt(v),ee&&ee.d(),I&&I.d(),U&&U.d(),T&&T.d()}}}function Wn(t,e,l){let n;ft(t,de,x=>l(13,n=x));let{currentStep:o=1}=e;const c=Bt();let r=null,f=!1,d=30,u=Number(sessionStorage.getItem("playerHeight"))||174,h=Number(sessionStorage.getItem("playerWeight"))||60,p="",m=!1,y=!1,g=!1,C=[],b=null,v=!1,S="";async function k(x){if(r=x.target.files[0],r){const H=sessionStorage.getItem("playerHeight"),L=sessionStorage.getItem("playerWeight");H&&l(3,u=Number(H)||u),L&&l(4,h=Number(L)||h);try{const B=URL.createObjectURL(r);un(B)}catch{}Yt("upload"),await W()}}async function W(){if(!r)return;l(1,f=!0),l(5,p="");const x=new FormData;x.append("video",r);try{const L=await(await fetch(`${Be()}/api/video/upload`,{method:"POST",body:x})).json();L.success?(l(2,d=Math.round(L.fps)||30),c("stepComplete",{step:1,data:L})):l(5,p=L.error||"Errore caricamento video")}catch{l(5,p="Errore di connessione al server")}finally{l(1,f=!1)}}function w(){l(12,S=""),l(8,g=!0),P()}async function P(){l(11,v=!0),l(9,C=[]),l(10,b=null);try{const x=await jn();x.length>0?(l(9,C=x),l(10,b=0)):l(12,S="Nessuna fotocamera trovata")}catch{l(12,S="Errore rilevamento fotocamere")}finally{l(11,v=!1)}}async function M(){if(l(12,S=""),b==null){l(12,S="Seleziona una fotocamera");return}try{l(8,g=!1);try{Gt(n.previewStream);const x=await Sn(Number(b),C);fn(x),Ut(!0),Yt("camera")}catch{l(12,S="Impossibile avviare l'anteprima fotocamera")}}catch{l(12,S="Errore apertura anteprima")}}async function q(){try{if(b!=null)try{await Ae.setCamera(Number(b))}catch{l(5,p="Errore impostazione fotocamera");return}try{Gt(n.previewStream)}catch{}Wt(),Ut(!1);const x=await Ae.startRecording();x.success?de.update(H=>({...H,isRecording:!0})):l(5,p=x.error||"Errore avvio registrazione")}catch{l(5,p="Errore di connessione al server")}}async function D(){try{const H=await(await fetch(`${Be()}/api/recording/stop`,{method:"POST"})).json();H.success&&(de.update(L=>({...L,isRecording:!1})),c("stepComplete",{step:1,data:H}))}catch{l(5,p="Errore stop registrazione")}}async function A(){l(5,p="");try{await Ae.setFps(d),await Ae.setHeight(u),await Ae.setMass(h)}catch{l(5,p="Errore impostazioni");return}try{const x=await fetch(`${Be()}/api/video/info`).then(H=>H.json());if(!(x!=null&&x.video_path)){l(5,p="Nessun video disponibile. Registra o carica prima il video.");return}}catch{l(5,p="Errore verifica video disponibile");return}try{const x=await Ae.startCalibration();x.success?(l(6,m=!0),de.update(H=>({...H,isCalibrating:!0})),N()):l(5,p=x.error||"Errore calibrazione")}catch{l(5,p="Errore di connessione")}}async function N(){const x=setInterval(async()=>{try{const H=await Ae.calibrationStatus();H.success&&!H.in_progress?(clearInterval(x),l(6,m=!1),de.update(L=>({...L,isCalibrating:!1})),c("stepComplete",{step:2,data:H}),await le()):H.success===!1&&!H.in_progress&&(clearInterval(x),l(6,m=!1),de.update(L=>({...L,isCalibrating:!1})),l(5,p="Calibrazione fallita"))}catch{clearInterval(x),l(6,m=!1),l(5,p="Errore verifica calibrazione")}},500)}async function le(){l(5,p="");try{const x=await Ae.startAnalysis();x.success?(l(7,y=!0),de.update(H=>({...H,isAnalyzing:!0})),ae()):l(5,p=x.error||"Errore avvio analisi")}catch{l(5,p="Errore di connessione")}}async function ae(){const x=setInterval(async()=>{try{if(!(await Ae.analysisStatus()).is_analyzing){clearInterval(x);const L=await Ae.analysisResults();L.success&&(l(7,y=!1),de.update(B=>({...B,isAnalyzing:!1})),c("stepComplete",{step:3,data:{...L.results,trajectory:L.trajectory,velocity:L.velocity,phase_times:L.phase_times}}))}}catch{}},500)}async function ee(){try{await Ae.pauseAnalysis(),de.update(x=>({...x,isPaused:!0}))}catch{}}async function I(){try{await Ae.resumeAnalysis(),de.update(x=>({...x,isPaused:!1}))}catch{}}async function U(){try{await Ae.stopAnalysis()}catch{}c("cancelToStep1")}function T(){o===1&&n.isCameraPreview?E():c("goBack")}async function E(){try{Gt(n.previewStream)}catch{}Wt(),Ut(!1),Yt("none"),l(10,b=null)}function j(x){b=x,l(10,b)}const V=()=>l(8,g=!1),J=x=>l(10,b=x.detail.index);function Y(){d=st(this.value),l(2,d)}function Q(){u=st(this.value),l(3,u)}function oe(){h=st(this.value),l(4,h)}return t.$$set=x=>{"currentStep"in x&&l(0,o=x.currentStep)},[o,f,d,u,h,p,m,y,g,C,b,v,S,n,k,w,M,q,D,A,le,ee,I,U,T,j,V,J,Y,Q,oe]}class Yn extends vt{constructor(e){super(),_t(this,e,Wn,Un,nt,{currentStep:0},null,[-1,-1])}}function jl(t,e,l){const n=t.slice();n[18]=e[l],n[22]=l;const o=n[18].id===n[7];n[19]=o;const c=n[4].includes(n[18].id);return n[20]=c,n}function Gn(t){let e,l=Ht(t[1]),n=[];for(let o=0;o<l.length;o+=1)n[o]=Tl(jl(t,l,o));return{c(){for(let o=0;o<n.length;o+=1)n[o].c();e=Tt()},m(o,c){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(o,c);R(o,e,c)},p(o,c){if(c&402){l=Ht(o[1]);let r;for(r=0;r<l.length;r+=1){const f=jl(o,l,r);n[r]?n[r].p(f,c):(n[r]=Tl(f),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=l.length}},d(o){o&&F(e),el(n,o)}}}function qn(t){let e;return{c(){e=a("tr"),e.innerHTML='<td colspan="7" class="p-8 text-center text-slate-400">Nessun salto nella sessione</td>'},m(l,n){R(l,e,n)},p:te,d(l){l&&F(e)}}}function Sl(t){let e;return{c(){e=a("span"),e.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"></path></svg>
                                        Best`,i(e,"class","flex items-center gap-1 px-2 py-0.5 rounded bg-emerald-500/20 text-emerald-400 text-[10px] font-bold uppercase border border-emerald-500/30")},m(l,n){R(l,e,n)},d(l){l&&F(e)}}}function Zn(t){let e;return{c(){e=a("span"),e.textContent="--",i(e,"class","text-slate-500 text-xs")},m(l,n){R(l,e,n)},d(l){l&&F(e)}}}function Kn(t){let e;return{c(){e=a("span"),e.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg>
                                    Errore Acquisizione`,i(e,"class","text-red-400 text-xs flex items-center gap-1")},m(l,n){R(l,e,n)},d(l){l&&F(e)}}}function Tl(t){let e,l,n,o,c,r,f,d,u,h,p,m=(t[18].jump_detected?t[18].max_height.toFixed(2):"--")+"",y,g,C,b,v,S,k=(t[18].jump_detected?(t[18].calculated_estimated_power||t[18].estimated_power||0).toFixed(0):"--")+"",W,w,P,M,q,D=(t[18].jump_detected?t[18].flight_time:"--")+"",A,N,le,ae,ee,I=(t[18].jump_detected?(t[18].calculated_contact_time||t[18].contact_time||0).toFixed(3):"--")+"",U,T,E,j,V,J,Y,Q;function oe(){return t[15](t[18])}let x=t[19]&&t[18].jump_detected&&Sl();function H(z,Z){return z[18].jump_detected?Zn:Kn}let L=H(t),B=L(t);function ne(){return t[16](t[18])}return{c(){e=a("tr"),l=a("td"),n=a("input"),r=_(),f=a("td"),f.textContent=`${String(t[22]+1).padStart(2,"0")}`,d=_(),u=a("td"),h=a("div"),p=a("span"),y=O(m),C=_(),x&&x.c(),b=_(),v=a("td"),S=a("span"),W=O(k),P=_(),M=a("td"),q=a("span"),A=O(D),le=_(),ae=a("td"),ee=a("span"),U=O(I),E=_(),j=a("td"),B.c(),V=_(),i(n,"type","checkbox"),n.checked=o=t[20],n.disabled=c=!t[18].jump_detected,i(n,"class","w-4 h-4 rounded border-slate-600 bg-slate-700 text-indigo-600 focus:ring-indigo-500 focus:ring-offset-slate-800 disabled:opacity-50"),i(l,"class","p-4 text-center"),i(f,"class","p-4 font-mono text-slate-400 text-sm"),i(p,"class",g="text-lg font-bold "+(t[18].jump_detected?"text-white":"text-slate-600")),i(h,"class","flex items-center gap-2"),i(u,"class","p-4"),i(S,"class",w="font-mono "+(t[18].jump_detected?"text-yellow-400":"text-slate-600")),i(v,"class","p-4 hidden md:table-cell"),i(q,"class",N="font-mono "+(t[18].jump_detected?"text-blue-400":"text-slate-600")),i(M,"class","p-4 hidden sm:table-cell"),i(ee,"class",T="font-mono "+(t[18].jump_detected?"text-slate-300":"text-slate-600")),i(ae,"class","p-4 hidden lg:table-cell"),i(j,"class","p-4"),i(e,"class",J="transition-colors hover:bg-slate-700/50 cursor-pointer "+(t[20]?"bg-indigo-900/10":"")+" "+(t[19]?"bg-emerald-900/10":""))},m(z,Z){R(z,e,Z),s(e,l),s(l,n),s(e,r),s(e,f),s(e,d),s(e,u),s(u,h),s(h,p),s(p,y),s(h,C),x&&x.m(h,null),s(e,b),s(e,v),s(v,S),s(S,W),s(e,P),s(e,M),s(M,q),s(q,A),s(e,le),s(e,ae),s(ae,ee),s(ee,U),s(e,E),s(e,j),B.m(j,null),s(e,V),Y||(Q=[$(n,"change",oe),$(l,"click",Zl(Xn)),$(e,"click",ne)],Y=!0)},p(z,Z){t=z,Z&18&&o!==(o=t[20])&&(n.checked=o),Z&2&&c!==(c=!t[18].jump_detected)&&(n.disabled=c),Z&2&&m!==(m=(t[18].jump_detected?t[18].max_height.toFixed(2):"--")+"")&&ie(y,m),Z&2&&g!==(g="text-lg font-bold "+(t[18].jump_detected?"text-white":"text-slate-600"))&&i(p,"class",g),t[19]&&t[18].jump_detected?x||(x=Sl(),x.c(),x.m(h,null)):x&&(x.d(1),x=null),Z&2&&k!==(k=(t[18].jump_detected?(t[18].calculated_estimated_power||t[18].estimated_power||0).toFixed(0):"--")+"")&&ie(W,k),Z&2&&w!==(w="font-mono "+(t[18].jump_detected?"text-yellow-400":"text-slate-600"))&&i(S,"class",w),Z&2&&D!==(D=(t[18].jump_detected?t[18].flight_time:"--")+"")&&ie(A,D),Z&2&&N!==(N="font-mono "+(t[18].jump_detected?"text-blue-400":"text-slate-600"))&&i(q,"class",N),Z&2&&I!==(I=(t[18].jump_detected?(t[18].calculated_contact_time||t[18].contact_time||0).toFixed(3):"--")+"")&&ie(U,I),Z&2&&T!==(T="font-mono "+(t[18].jump_detected?"text-slate-300":"text-slate-600"))&&i(ee,"class",T),L!==(L=H(t))&&(B.d(1),B=L(t),B&&(B.c(),B.m(j,null))),Z&146&&J!==(J="transition-colors hover:bg-slate-700/50 cursor-pointer "+(t[20]?"bg-indigo-900/10":"")+" "+(t[19]?"bg-emerald-900/10":""))&&i(e,"class",J)},d(z){z&&F(e),x&&x.d(),B.d(),Y=!1,Me(Q)}}}function Ml(t){let e,l,n;return{c(){e=a("div"),l=O(t[3]),i(e,"class",n="text-center text-xs font-medium "+(t[3].includes("completato")?"text-emerald-400":"text-red-400")+" bg-slate-900/50 py-1 px-3 rounded")},m(o,c){R(o,e,c),s(e,l)},p(o,c){c&8&&ie(l,o[3]),c&8&&n!==(n="text-center text-xs font-medium "+(o[3].includes("completato")?"text-emerald-400":"text-red-400")+" bg-slate-900/50 py-1 px-3 rounded")&&i(e,"class",n)},d(o){o&&F(e)}}}function Qn(t){let e,l,n,o,c,r,f,d,u,h,p=t[1].length+"",m,y,g,C,b,v,S,k,W=t[6].toFixed(2)+"",w,P,M,q,D,A,N,le,ae,ee,I,U,T,E,j,V,J,Y,Q,oe,x,H,L,B,ne,z,Z,ue,G,se,pe,he,Ve,xe,Fe,Ce,Ie,Ee,ye,Se=t[4].length+"",Re,Xe,X,me,ce,ge,$e,yt,at,rt,Ye,ke,kt,ze,Ge,Te,be,qe,et,Oe,zt,Ct,Ze,je,_e,Ke,tt,Je,ct,jt,dt,St,Pt;function Dt(re,K){return re[1].length===0?qn:Gn}let ut=Dt(t),Pe=ut(t),ve=t[3]&&Ml(t);return{c(){e=a("div"),l=a("div"),n=a("div"),o=a("div"),c=a("button"),c.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>
                Torna all&#39;analisi`,r=_(),f=a("h1"),f.textContent="Riepilogo Sessione",d=_(),u=a("p"),h=O("Hai completato "),m=O(p),y=O(" salti. Seleziona quelli da salvare."),g=_(),C=a("div"),b=a("div"),v=a("span"),v.textContent="Miglior Altezza",S=_(),k=a("span"),w=O(W),P=_(),M=a("span"),M.textContent="cm",q=_(),D=a("div"),A=a("span"),A.textContent="Media Potenza",N=_(),le=a("span"),ae=O(t[5]),ee=_(),I=a("span"),I.textContent="W",U=_(),T=a("div"),E=a("div"),j=a("table"),V=a("thead"),J=a("tr"),Y=a("th"),Q=a("input"),x=_(),H=a("th"),H.textContent="#",L=_(),B=a("th"),B.textContent="Altezza (cm)",ne=_(),z=a("th"),z.textContent="Potenza (W)",Z=_(),ue=a("th"),ue.textContent="T. Volo (s)",G=_(),se=a("th"),se.textContent="T. Contatto (s)",pe=_(),he=a("th"),he.textContent="Note",Ve=_(),xe=a("tbody"),Pe.c(),Fe=_(),Ce=a("div"),Ie=a("div"),Ee=a("span"),ye=a("span"),Re=O(Se),Xe=O(" salti selezionati"),X=_(),me=a("button"),ce=fe("svg"),ge=fe("polyline"),$e=fe("path"),yt=_(),at=a("span"),at.textContent="Deseleziona tutti",Ye=_(),ke=a("div"),ve&&ve.c(),kt=_(),ze=a("button"),ze.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
            Esci senza salvare`,Ge=_(),Te=a("button"),be=fe("svg"),qe=fe("path"),et=fe("polyline"),Oe=fe("line"),zt=_(),Ct=a("span"),Ct.textContent="Upload dopo",Ze=_(),je=a("button"),_e=fe("svg"),Ke=fe("path"),tt=fe("polyline"),Je=fe("line"),ct=_(),jt=a("span"),jt.textContent="Upload adesso",i(c,"class","text-slate-400 hover:text-white transition-colors flex items-center gap-1 text-sm"),i(o,"class","flex items-center gap-2 mb-1"),i(f,"class","text-3xl font-bold text-white mb-2"),i(u,"class","text-slate-400"),i(v,"class","text-xs text-slate-400 uppercase tracking-wider block mb-1"),i(M,"class","text-sm font-normal text-slate-500"),i(k,"class","text-2xl font-bold text-emerald-400"),i(b,"class","bg-slate-800 p-4 rounded-xl border border-slate-700 min-w-[120px]"),i(A,"class","text-xs text-slate-400 uppercase tracking-wider block mb-1"),i(I,"class","text-sm font-normal text-slate-500"),i(le,"class","text-2xl font-bold text-yellow-400"),i(D,"class","bg-slate-800 p-4 rounded-xl border border-slate-700 min-w-[120px]"),i(C,"class","flex gap-4"),i(l,"class","flex flex-col md:flex-row justify-between items-start md:items-end mb-8 gap-4"),i(Q,"type","checkbox"),i(Q,"class","w-4 h-4 rounded border-slate-600 bg-slate-700 text-indigo-600 focus:ring-indigo-500 focus:ring-offset-slate-800"),Q.checked=oe=t[4].length>0&&t[4].length===t[0].length,i(Y,"class","p-4 w-12 text-center"),i(H,"class","p-4 text-xs font-semibold text-slate-400 uppercase tracking-wider"),i(B,"class","p-4 text-xs font-semibold text-slate-400 uppercase tracking-wider"),i(z,"class","p-4 text-xs font-semibold text-slate-400 uppercase tracking-wider hidden md:table-cell"),i(ue,"class","p-4 text-xs font-semibold text-slate-400 uppercase tracking-wider hidden sm:table-cell"),i(se,"class","p-4 text-xs font-semibold text-slate-400 uppercase tracking-wider hidden lg:table-cell"),i(he,"class","p-4 text-xs font-semibold text-slate-400 uppercase tracking-wider"),i(J,"class","bg-slate-900/50 border-b border-slate-700"),i(xe,"class","divide-y divide-slate-700"),i(j,"class","w-full text-left border-collapse"),i(E,"class","overflow-x-auto"),i(T,"class","bg-slate-800 rounded-2xl border border-slate-700 overflow-hidden flex-1 shadow-2xl mb-20"),i(ye,"class","text-white font-bold"),i(Ee,"class","text-slate-300 font-medium"),i(ge,"points","3 6 5 6 21 6"),i($e,"d","M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"),i(ce,"xmlns","http://www.w3.org/2000/svg"),i(ce,"width","16"),i(ce,"height","16"),i(ce,"viewBox","0 0 24 24"),i(ce,"fill","none"),i(ce,"stroke","currentColor"),i(ce,"stroke-width","2"),i(ce,"stroke-linecap","round"),i(ce,"stroke-linejoin","round"),i(at,"class","hidden sm:inline"),i(me,"class","text-slate-400 hover:text-red-400 text-sm flex items-center gap-1 transition-colors px-3 py-2 rounded-lg hover:bg-slate-700/50"),me.disabled=rt=t[4].length===0,i(Ie,"class","flex items-center gap-4 w-full md:w-auto justify-between md:justify-start"),i(ze,"id","exitWithutSavingBtn"),i(ze,"class","w-full sm:w-auto text-red-400 hover:text-red-300 text-sm font-medium transition-colors px-4 py-2 flex items-center justify-center gap-2 hover:bg-red-500/10 rounded-xl"),i(qe,"d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"),i(et,"points","17 8 12 3 7 8"),i(Oe,"x1","12"),i(Oe,"y1","3"),i(Oe,"x2","12"),i(Oe,"y2","15"),i(be,"xmlns","http://www.w3.org/2000/svg"),i(be,"width","16"),i(be,"height","16"),i(be,"viewBox","0 0 24 24"),i(be,"fill","none"),i(be,"stroke","currentColor"),i(be,"stroke-width","2"),i(be,"stroke-linecap","round"),i(be,"stroke-linejoin","round"),i(Te,"id","uploadLaterBtn"),i(Te,"class","w-full sm:w-auto flex items-center justify-center gap-2 px-5 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-medium transition-all border border-slate-600 hover:border-slate-500 shadow-sm"),Te.disabled=t[2],i(Ke,"d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"),i(tt,"points","17 8 12 3 7 8"),i(Je,"x1","12"),i(Je,"y1","3"),i(Je,"x2","12"),i(Je,"y2","15"),i(_e,"xmlns","http://www.w3.org/2000/svg"),i(_e,"width","16"),i(_e,"height","16"),i(_e,"viewBox","0 0 24 24"),i(_e,"fill","none"),i(_e,"stroke","currentColor"),i(_e,"stroke-width","2"),i(_e,"stroke-linecap","round"),i(_e,"stroke-linejoin","round"),i(je,"id","uploadBtn"),i(je,"class","w-full sm:w-auto flex items-center justify-center gap-2 px-6 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold transition-all shadow-lg shadow-indigo-900/50 transform active:scale-95 hover:-translate-y-0.5"),je.disabled=dt=t[2]||t[4].length===0,i(ke,"class","flex flex-col sm:flex-row items-center gap-3 w-full md:w-auto"),i(Ce,"class","fixed bottom-6 left-1/2 transform -translate-x-1/2 w-[95%] max-w-5xl bg-slate-800/90 backdrop-blur-md border border-slate-600 p-4 rounded-2xl shadow-2xl flex flex-col md:flex-row items-center justify-between gap-4 z-50"),i(e,"class","min-h-screen w-full flex flex-col bg-slate-900 p-4 md:p-8 animate-in fade-in zoom-in-95 duration-300 svelte-17v63fj")},m(re,K){R(re,e,K),s(e,l),s(l,n),s(n,o),s(o,c),s(n,r),s(n,f),s(n,d),s(n,u),s(u,h),s(u,m),s(u,y),s(l,g),s(l,C),s(C,b),s(b,v),s(b,S),s(b,k),s(k,w),s(k,P),s(k,M),s(C,q),s(C,D),s(D,A),s(D,N),s(D,le),s(le,ae),s(le,ee),s(le,I),s(e,U),s(e,T),s(T,E),s(E,j),s(j,V),s(V,J),s(J,Y),s(Y,Q),s(J,x),s(J,H),s(J,L),s(J,B),s(J,ne),s(J,z),s(J,Z),s(J,ue),s(J,G),s(J,se),s(J,pe),s(J,he),s(j,Ve),s(j,xe),Pe.m(xe,null),s(e,Fe),s(e,Ce),s(Ce,Ie),s(Ie,Ee),s(Ee,ye),s(ye,Re),s(Ee,Xe),s(Ie,X),s(Ie,me),s(me,ce),s(ce,ge),s(ce,$e),s(me,yt),s(me,at),s(Ce,Ye),s(Ce,ke),ve&&ve.m(ke,null),s(ke,kt),s(ke,ze),s(ke,Ge),s(ke,Te),s(Te,be),s(be,qe),s(be,et),s(be,Oe),s(Te,zt),s(Te,Ct),s(ke,Ze),s(ke,je),s(je,_e),s(_e,Ke),s(_e,tt),s(_e,Je),s(je,ct),s(je,jt),St||(Pt=[$(c,"click",t[13]),$(Q,"change",t[9]),$(me,"click",t[10]),$(ze,"click",t[12]),$(je,"click",t[11])],St=!0)},p(re,[K]){K&2&&p!==(p=re[1].length+"")&&ie(m,p),K&64&&W!==(W=re[6].toFixed(2)+"")&&ie(w,W),K&32&&ie(ae,re[5]),K&17&&oe!==(oe=re[4].length>0&&re[4].length===re[0].length)&&(Q.checked=oe),ut===(ut=Dt(re))&&Pe?Pe.p(re,K):(Pe.d(1),Pe=ut(re),Pe&&(Pe.c(),Pe.m(xe,null))),K&16&&Se!==(Se=re[4].length+"")&&ie(Re,Se),K&16&&rt!==(rt=re[4].length===0)&&(me.disabled=rt),re[3]?ve?ve.p(re,K):(ve=Ml(re),ve.c(),ve.m(ke,kt)):ve&&(ve.d(1),ve=null),K&4&&(Te.disabled=re[2]),K&20&&dt!==(dt=re[2]||re[4].length===0)&&(je.disabled=dt)},i:te,o:te,d(re){re&&F(e),Pe.d(),ve&&ve.d(),St=!1,Me(Pt)}}}const Xn=()=>{};function $n(t,e,l){let n,o,c,r,f,d,u;ft(t,xt,w=>l(14,u=w));const h=Bt();let p=!1,m="";function y(w){xt.update(P=>P.selectedJumpIds.includes(w)?{...P,selectedJumpIds:P.selectedJumpIds.filter(M=>M!==w)}:{...P,selectedJumpIds:[...P.selectedJumpIds,w]})}function g(){xt.update(w=>w.selectedJumpIds.length===r.length?{...w,selectedJumpIds:[]}:{...w,selectedJumpIds:r.map(P=>P.id)})}function C(){xt.update(w=>({...w,selectedJumpIds:[]}))}async function b(){if(o.length===0){l(3,m="Seleziona almeno un salto"),setTimeout(()=>l(3,m=""),3e3);return}l(2,p=!0),l(3,m="");try{const P=await(await fetch(`${Be()}/api/results/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jump_ids:o})})).json();P.success?(l(3,m="Upload completato!"),setTimeout(()=>{h("uploadComplete")},1500)):l(3,m=P.error||"Errore upload")}catch{l(3,m="Errore connessione")}finally{l(2,p=!1),setTimeout(()=>l(3,m=""),3e3)}}function v(){confirm("Sei sicuro di voler uscire senza salvare? Tutti i dati della sessione corrente andranno persi.")&&h("exitNoSave")}function S(){h("backToAnalysis")}const k=w=>y(w.id),W=w=>w.jump_detected&&y(w.id);return t.$$.update=()=>{t.$$.dirty&16384&&l(1,n=u.jumps),t.$$.dirty&16384&&l(4,o=u.selectedJumpIds),t.$$.dirty&2&&l(7,c=n.length>0?n.reduce((w,P)=>{if(!w)return P.jump_detected?P.id:null;const M=n.find(q=>q.id===w);return P.jump_detected&&P.max_height>((M==null?void 0:M.max_height)||0)?P.id:w},null):null),t.$$.dirty&2&&l(0,r=n.filter(w=>w.jump_detected)),t.$$.dirty&1&&l(6,f=r.length>0?Math.max(...r.map(w=>w.max_height)):0),t.$$.dirty&1&&l(5,d=r.length>0?Math.round(r.reduce((w,P)=>w+(P.calculated_estimated_power||P.estimated_power||0),0)/r.length):0)},[r,n,p,m,o,d,f,c,y,g,C,b,v,S,u,k,W]}class es extends vt{constructor(e){super(),_t(this,e,$n,Qn,nt,{})}}function ts(t){var ue;let e,l,n,o,c,r,f,d=(ue=t[5])!=null&&ue.jump_detected?"Analisi Completata":"Salto Non Valido",u,h,p,m,y=t[3].jumps.length+"",g,C,b,v,S,k,W,w,P,M,q,D,A,N,le,ae,ee,I,U,T,E,j,V,J,Y,Q,oe,x,H,L,B=t[0]==="metrics"&&Al(),ne=t[0]==="charts"&&El(),z=t[0]==="metrics"&&zl(t),Z=t[0]==="charts"&&Pl(t);return{c(){e=a("div"),l=a("div"),n=a("div"),o=a("div"),c=a("span"),c.innerHTML='<span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-2.5 w-2.5 bg-emerald-500"></span>',r=_(),f=a("span"),u=O(d),h=_(),p=a("span"),m=O("SESSIONE IN CORSO  "),g=O(y),C=O(" SALTI"),b=_(),v=a("div"),S=a("button"),k=fe("svg"),W=fe("path"),P=O(`
         Metriche
         `),B&&B.c(),q=_(),D=a("button"),A=fe("svg"),N=fe("polyline"),le=fe("polyline"),ee=O(`
         Grafici
         `),ne&&ne.c(),U=_(),T=a("div"),z&&z.c(),E=_(),Z&&Z.c(),j=_(),V=a("div"),J=_(),Y=a("div"),Q=a("button"),Q.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>
            Concludi Sessione`,oe=_(),x=a("button"),x.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2v6h-6"></path><path d="M3 12a9 9 0 0 1 15-6.7L21 8"></path><path d="M3 22v-6h6"></path><path d="M21 12a9 9 0 0 1-15 6.7L3 16"></path></svg>
            Nuova Analisi`,i(c,"class","relative flex h-2.5 w-2.5"),i(f,"class","text-emerald-400 text-xs font-bold uppercase tracking-wider"),i(o,"class","flex items-center gap-2.5"),i(p,"class","text-[10px] text-slate-500 font-mono bg-slate-800 px-1.5 py-0.5 rounded border border-slate-700"),i(n,"class","px-5 py-3 flex items-center justify-between bg-emerald-950/30 border-b border-emerald-500/10"),i(W,"d","M22 12h-4l-3 9L9 3l-3 9H2"),i(k,"xmlns","http://www.w3.org/2000/svg"),i(k,"width","16"),i(k,"height","16"),i(k,"viewBox","0 0 24 24"),i(k,"fill","none"),i(k,"stroke","currentColor"),i(k,"stroke-width","2"),i(k,"stroke-linecap","round"),i(k,"stroke-linejoin","round"),i(k,"class",w=t[0]==="metrics"?"text-indigo-400":""),i(S,"class",M=De(`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-all relative ${t[0]==="metrics"?"text-white":"text-slate-500 hover:text-slate-300"}`)+" svelte-l1fefl"),i(N,"points","23 6 13.5 15.5 8.5 10.5 1 18"),i(le,"points","17 6 23 6 23 12"),i(A,"xmlns","http://www.w3.org/2000/svg"),i(A,"width","16"),i(A,"height","16"),i(A,"viewBox","0 0 24 24"),i(A,"fill","none"),i(A,"stroke","currentColor"),i(A,"stroke-width","2"),i(A,"stroke-linecap","round"),i(A,"stroke-linejoin","round"),i(A,"class",ae=t[0]==="charts"?"text-indigo-400":""),i(D,"class",I=De(`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-all relative ${t[0]==="charts"?"text-white":"text-slate-500 hover:text-slate-300"}`)+" svelte-l1fefl"),i(v,"class","flex border-b border-slate-800 bg-slate-900/50"),i(l,"class","shrink-0 bg-slate-900 z-10"),i(T,"class","flex-1 overflow-y-auto p-5 custom-scrollbar bg-slate-900/50 svelte-l1fefl"),i(Q,"class","flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-700 text-slate-200 py-3 rounded-xl text-sm font-semibold transition-all border border-slate-700 hover:border-slate-600 active:scale-[0.98]"),i(x,"class","flex items-center justify-center gap-2 bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl text-sm font-semibold transition-all shadow-lg shadow-indigo-900/20 hover:shadow-indigo-900/40 active:scale-[0.98]"),i(Y,"class","grid grid-cols-2 gap-3"),i(V,"class","shrink-0 p-4 bg-slate-900 border-t border-slate-800 z-20 shadow-[0_-5px_20px_rgba(0,0,0,0.3)]"),i(e,"class","bg-slate-900 rounded-2xl border border-slate-800 shadow-xl overflow-hidden relative ring-1 ring-white/5 flex flex-col h-full w-full")},m(G,se){R(G,e,se),s(e,l),s(l,n),s(n,o),s(o,c),s(o,r),s(o,f),s(f,u),s(n,h),s(n,p),s(p,m),s(p,g),s(p,C),s(l,b),s(l,v),s(v,S),s(S,k),s(k,W),s(S,P),B&&B.m(S,null),s(v,q),s(v,D),s(D,A),s(A,N),s(A,le),s(D,ee),ne&&ne.m(D,null),s(e,U),s(e,T),z&&z.m(T,null),s(T,E),Z&&Z.m(T,null),s(e,j),s(e,V),s(V,J),s(V,Y),s(Y,Q),s(Y,oe),s(Y,x),H||(L=[$(S,"click",t[13]),$(D,"click",t[14]),$(Q,"click",t[7]),$(x,"click",t[19])],H=!0)},p(G,se){var pe;se&32&&d!==(d=(pe=G[5])!=null&&pe.jump_detected?"Analisi Completata":"Salto Non Valido")&&ie(u,d),se&8&&y!==(y=G[3].jumps.length+"")&&ie(g,y),se&1&&w!==(w=G[0]==="metrics"?"text-indigo-400":"")&&i(k,"class",w),G[0]==="metrics"?B||(B=Al(),B.c(),B.m(S,null)):B&&(B.d(1),B=null),se&1&&M!==(M=De(`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-all relative ${G[0]==="metrics"?"text-white":"text-slate-500 hover:text-slate-300"}`)+" svelte-l1fefl")&&i(S,"class",M),se&1&&ae!==(ae=G[0]==="charts"?"text-indigo-400":"")&&i(A,"class",ae),G[0]==="charts"?ne||(ne=El(),ne.c(),ne.m(D,null)):ne&&(ne.d(1),ne=null),se&1&&I!==(I=De(`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-all relative ${G[0]==="charts"?"text-white":"text-slate-500 hover:text-slate-300"}`)+" svelte-l1fefl")&&i(D,"class",I),G[0]==="metrics"?z?z.p(G,se):(z=zl(G),z.c(),z.m(T,E)):z&&(z.d(1),z=null),G[0]==="charts"?Z?Z.p(G,se):(Z=Pl(G),Z.c(),Z.m(T,null)):Z&&(Z.d(1),Z=null)},i:te,o:te,d(G){G&&F(e),B&&B.d(),ne&&ne.d(),z&&z.d(),Z&&Z.d(),H=!1,Me(L)}}}function ls(t){let e,l,n;return l=new es({}),l.$on("backToAnalysis",t[8]),l.$on("exitNoSave",t[9]),l.$on("uploadComplete",t[10]),{c(){e=a("div"),Et(l.$$.fragment),i(e,"class","fixed inset-x-0 top-14 bottom-0 z-50 bg-slate-950 overflow-auto")},m(o,c){R(o,e,c),gt(l,e,null),n=!0},p:te,i(o){n||(Ne(l.$$.fragment,o),n=!0)},o(o){We(l.$$.fragment,o),n=!1},d(o){o&&F(e),bt(l)}}}function Al(t){let e;return{c(){e=a("div"),i(e,"class","absolute bottom-0 left-0 right-0 h-0.5 bg-indigo-500 shadow-[0_0_10px_rgba(99,102,241,0.5)]")},m(l,n){R(l,e,n)},d(l){l&&F(e)}}}function El(t){let e;return{c(){e=a("div"),i(e,"class","absolute bottom-0 left-0 right-0 h-0.5 bg-indigo-500 shadow-[0_0_10px_rgba(99,102,241,0.5)]")},m(l,n){R(l,e,n)},d(l){l&&F(e)}}}function zl(t){var jt,dt,St,Pt,Dt,ut,Pe,ve,re;let e,l,n,o,c,r,f,d=((jt=t[5])!=null&&jt.jump_detected&&t[5].max_height||"--")+"",u,h,p,m,y,g,C,b,v,S=((dt=t[5])!=null&&dt.jump_detected&&t[5].flight_time||"--")+"",k,W,w,P,M,q,D,A,N,le=((St=t[5])!=null&&St.jump_detected?(t[5].calculated_takeoff_velocity||t[5].takeoff_velocity||0).toFixed(1):"--")+"",ae,ee,I,U,T,E,j,V,J,Y=((Pt=t[5])!=null&&Pt.jump_detected?(t[5].calculated_estimated_power||t[5].estimated_power||0).toFixed(0):"--")+"",Q,oe,x,H,L,B,ne,z,Z,ue,G,se,pe=((Dt=t[5])!=null&&Dt.jump_detected?(t[5].calculated_contact_time||t[5].contact_time||0).toFixed(3):"--")+"",he,Ve,xe,Fe,Ce,Ie,Ee,ye=((ut=t[5])!=null&&ut.jump_detected?(t[5].calculated_eccentric_time||t[5].eccentric_time||0).toFixed(3):"--")+"",Se,Re,Xe,X,me,ce,ge,$e=((Pe=t[5])!=null&&Pe.jump_detected?(t[5].calculated_concentric_time||t[5].concentric_time||0).toFixed(3):"--")+"",yt,at,rt,Ye,ke,kt,ze,Ge,Te,be,qe,et=((ve=t[5])!=null&&ve.jump_detected?(t[5].calculated_average_force||t[5].average_force||0).toFixed(1):"--")+"",Oe,zt,Ct,Ze,je,_e,Ke,tt=(re=t[5])!=null&&re.jump_detected?"S":"No",Je,ct;return{c(){var K;e=a("div"),l=a("div"),n=a("div"),o=a("div"),o.innerHTML='<span class="text-[10px] text-slate-400 uppercase tracking-wide font-semibold">Altezza Max</span> <svg class="w-3 h-3 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline></svg>',c=_(),r=a("div"),f=a("span"),u=O(d),h=_(),p=a("span"),p.textContent="cm",m=_(),y=a("div"),g=a("div"),g.innerHTML='<span class="text-[10px] text-slate-400 uppercase tracking-wide font-semibold">Tempo Volo</span> <svg class="w-3 h-3 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>',C=_(),b=a("div"),v=a("span"),k=O(S),W=_(),w=a("span"),w.textContent="s",P=_(),M=a("div"),q=a("div"),q.innerHTML='<span class="text-[10px] text-slate-400 uppercase tracking-wide font-semibold">Vel. Decollo</span> <svg class="w-3 h-3 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M22 12h-4l-3 9L9 3l-3 9H2"></path></svg>',D=_(),A=a("div"),N=a("span"),ae=O(le),ee=_(),I=a("span"),I.textContent="cm/s",U=_(),T=a("div"),E=a("div"),E.innerHTML='<span class="text-[10px] text-slate-400 uppercase tracking-wide font-semibold">Potenza</span> <svg class="w-3 h-3 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>',j=_(),V=a("div"),J=a("span"),Q=O(Y),oe=_(),x=a("span"),x.textContent="W",H=_(),L=a("div"),B=a("div"),B.innerHTML='<h3 class="text-[10px] font-bold text-slate-400 uppercase tracking-wider flex items-center gap-2">Fasi Temporali</h3>',ne=_(),z=a("div"),Z=a("div"),ue=a("span"),ue.textContent="Tempo Contatto",G=_(),se=a("span"),he=O(pe),Ve=O(" s"),xe=_(),Fe=a("div"),Ce=a("span"),Ce.textContent="Fase Eccentrica",Ie=_(),Ee=a("span"),Se=O(ye),Re=O(" s"),Xe=_(),X=a("div"),me=a("span"),me.textContent="Fase Concentrica",ce=_(),ge=a("span"),yt=O($e),at=O(" s"),rt=_(),Ye=a("div"),ke=a("div"),ke.innerHTML='<h3 class="text-[10px] font-bold text-slate-400 uppercase tracking-wider flex items-center gap-2">Biomeccanica</h3>',kt=_(),ze=a("div"),Ge=a("div"),Te=a("span"),Te.textContent="Forza Media",be=_(),qe=a("span"),Oe=O(et),zt=O(" N"),Ct=_(),Ze=a("div"),je=a("span"),je.textContent="Salto Valido",_e=_(),Ke=a("span"),Je=O(tt),i(o,"class","flex justify-between items-start mb-1"),i(f,"class","text-2xl font-bold tracking-tight text-emerald-400"),i(p,"class","text-xs text-slate-500 font-medium"),i(r,"class","flex items-baseline gap-1 mt-auto"),i(n,"class","relative group flex flex-col p-3 bg-slate-900/40 rounded-lg border border-slate-700/50 hover:border-slate-600 transition-all hover:bg-slate-800/60"),i(g,"class","flex justify-between items-start mb-1"),i(v,"class","text-2xl font-bold tracking-tight text-blue-400"),i(w,"class","text-xs text-slate-500 font-medium"),i(b,"class","flex items-baseline gap-1 mt-auto"),i(y,"class","relative group flex flex-col p-3 bg-slate-900/40 rounded-lg border border-slate-700/50 hover:border-slate-600 transition-all hover:bg-slate-800/60"),i(q,"class","flex justify-between items-start mb-1"),i(N,"class","text-2xl font-bold tracking-tight text-purple-400"),i(I,"class","text-xs text-slate-500 font-medium"),i(A,"class","flex items-baseline gap-1 mt-auto"),i(M,"class","relative group flex flex-col p-3 bg-slate-900/40 rounded-lg border border-slate-700/50 hover:border-slate-600 transition-all hover:bg-slate-800/60"),i(E,"class","flex justify-between items-start mb-1"),i(J,"class","text-2xl font-bold tracking-tight text-amber-400"),i(x,"class","text-xs text-slate-500 font-medium"),i(V,"class","flex items-baseline gap-1 mt-auto"),i(T,"class","relative group flex flex-col p-3 bg-slate-900/40 rounded-lg border border-slate-700/50 hover:border-slate-600 transition-all hover:bg-slate-800/60"),i(l,"class","grid grid-cols-2 gap-3"),i(B,"class","px-4 py-2 border-b border-slate-700 bg-slate-800/50 flex justify-between items-center"),i(ue,"class","text-sm text-slate-400 font-medium"),i(se,"class","text-sm font-mono font-bold text-slate-200"),i(Z,"class","flex justify-between items-center py-2 border-b border-slate-700/40 last:border-0"),i(Ce,"class","text-sm text-slate-400 font-medium"),i(Ee,"class","text-sm font-mono font-bold text-slate-200"),i(Fe,"class","flex justify-between items-center py-2 border-b border-slate-700/40 last:border-0"),i(me,"class","text-sm text-slate-400 font-medium"),i(ge,"class","text-sm font-mono font-bold text-slate-200"),i(X,"class","flex justify-between items-center py-2 border-b border-slate-700/40 last:border-0"),i(z,"class","p-4 flex flex-col gap-0.5"),i(L,"class","bg-slate-800 rounded-lg border border-slate-700 overflow-hidden shadow-sm"),i(ke,"class","px-4 py-2 border-b border-slate-700 bg-slate-800/50 flex justify-between items-center"),i(Te,"class","text-sm text-slate-400 font-medium"),i(qe,"class","text-sm font-mono font-bold text-slate-200"),i(Ge,"class","flex justify-between items-center py-2 border-b border-slate-700/40 last:border-0"),i(je,"class","text-sm text-slate-400 font-medium"),i(Ke,"class",ct=De(`text-sm font-mono font-bold px-2 py-0.5 rounded ${(K=t[5])!=null&&K.jump_detected?"text-emerald-400 bg-emerald-400/10":"text-red-400 bg-red-400/10"}`)+" svelte-l1fefl"),i(Ze,"class","flex justify-between items-center py-2 border-b border-slate-700/40 last:border-0"),i(ze,"class","p-4 flex flex-col gap-0.5"),i(Ye,"class","bg-slate-800 rounded-lg border border-slate-700 overflow-hidden shadow-sm"),i(e,"class","space-y-5")},m(K,Le){R(K,e,Le),s(e,l),s(l,n),s(n,o),s(n,c),s(n,r),s(r,f),s(f,u),s(r,h),s(r,p),s(l,m),s(l,y),s(y,g),s(y,C),s(y,b),s(b,v),s(v,k),s(b,W),s(b,w),s(l,P),s(l,M),s(M,q),s(M,D),s(M,A),s(A,N),s(N,ae),s(A,ee),s(A,I),s(l,U),s(l,T),s(T,E),s(T,j),s(T,V),s(V,J),s(J,Q),s(V,oe),s(V,x),s(e,H),s(e,L),s(L,B),s(L,ne),s(L,z),s(z,Z),s(Z,ue),s(Z,G),s(Z,se),s(se,he),s(se,Ve),s(z,xe),s(z,Fe),s(Fe,Ce),s(Fe,Ie),s(Fe,Ee),s(Ee,Se),s(Ee,Re),s(z,Xe),s(z,X),s(X,me),s(X,ce),s(X,ge),s(ge,yt),s(ge,at),s(e,rt),s(e,Ye),s(Ye,ke),s(Ye,kt),s(Ye,ze),s(ze,Ge),s(Ge,Te),s(Ge,be),s(Ge,qe),s(qe,Oe),s(qe,zt),s(ze,Ct),s(ze,Ze),s(Ze,je),s(Ze,_e),s(Ze,Ke),s(Ke,Je)},p(K,Le){var Bl,Fl,Rl,Hl,Nl,Vl,Ol,Jl,Ul,Wl;Le&32&&d!==(d=((Bl=K[5])!=null&&Bl.jump_detected&&K[5].max_height||"--")+"")&&ie(u,d),Le&32&&S!==(S=((Fl=K[5])!=null&&Fl.jump_detected&&K[5].flight_time||"--")+"")&&ie(k,S),Le&32&&le!==(le=((Rl=K[5])!=null&&Rl.jump_detected?(K[5].calculated_takeoff_velocity||K[5].takeoff_velocity||0).toFixed(1):"--")+"")&&ie(ae,le),Le&32&&Y!==(Y=((Hl=K[5])!=null&&Hl.jump_detected?(K[5].calculated_estimated_power||K[5].estimated_power||0).toFixed(0):"--")+"")&&ie(Q,Y),Le&32&&pe!==(pe=((Nl=K[5])!=null&&Nl.jump_detected?(K[5].calculated_contact_time||K[5].contact_time||0).toFixed(3):"--")+"")&&ie(he,pe),Le&32&&ye!==(ye=((Vl=K[5])!=null&&Vl.jump_detected?(K[5].calculated_eccentric_time||K[5].eccentric_time||0).toFixed(3):"--")+"")&&ie(Se,ye),Le&32&&$e!==($e=((Ol=K[5])!=null&&Ol.jump_detected?(K[5].calculated_concentric_time||K[5].concentric_time||0).toFixed(3):"--")+"")&&ie(yt,$e),Le&32&&et!==(et=((Jl=K[5])!=null&&Jl.jump_detected?(K[5].calculated_average_force||K[5].average_force||0).toFixed(1):"--")+"")&&ie(Oe,et),Le&32&&tt!==(tt=(Ul=K[5])!=null&&Ul.jump_detected?"S":"No")&&ie(Je,tt),Le&32&&ct!==(ct=De(`text-sm font-mono font-bold px-2 py-0.5 rounded ${(Wl=K[5])!=null&&Wl.jump_detected?"text-emerald-400 bg-emerald-400/10":"text-red-400 bg-red-400/10"}`)+" svelte-l1fefl")&&i(Ke,"class",ct)},d(K){K&&F(e)}}}function Pl(t){let e,l,n,o,c,r,f,d,u,h,p,m,y,g,C,b,v,S,k,W,w,P,M,q,D=(t[1]==="trajectory"||t[1]==="combined")&&Dl(),A=(t[1]==="velocity"||t[1]==="combined")&&Il();return{c(){e=a("div"),l=a("div"),n=a("h3"),n.textContent="Analisi Curve",o=_(),c=a("div"),r=a("button"),f=O("Pos."),u=_(),h=a("button"),p=O("Vel."),y=_(),g=a("button"),C=O("Conf."),v=_(),S=a("div"),k=a("canvas"),W=_(),w=a("div"),D&&D.c(),P=_(),A&&A.c(),i(n,"class","text-xs font-bold text-slate-400 uppercase"),i(r,"class",d=De(`px-3 py-1 rounded-md text-[10px] font-bold uppercase tracking-wide transition-all ${t[1]==="trajectory"?"bg-indigo-600 text-white shadow-sm":"text-slate-400 hover:text-white hover:bg-slate-700"}`)+" svelte-l1fefl"),i(h,"class",m=De(`px-3 py-1 rounded-md text-[10px] font-bold uppercase tracking-wide transition-all ${t[1]==="velocity"?"bg-indigo-600 text-white shadow-sm":"text-slate-400 hover:text-white hover:bg-slate-700"}`)+" svelte-l1fefl"),i(g,"class",b=De(`px-3 py-1 rounded-md text-[10px] font-bold uppercase tracking-wide transition-all ${t[1]==="combined"?"bg-indigo-600 text-white shadow-sm":"text-slate-400 hover:text-white hover:bg-slate-700"}`)+" svelte-l1fefl"),i(c,"class","flex gap-1 bg-slate-800 p-1 rounded-lg border border-slate-700"),i(l,"class","flex justify-between items-center mb-4"),i(k,"class","w-full h-full object-contain block"),i(w,"class","absolute top-4 right-4 bg-slate-900/90 p-3 rounded-lg border border-slate-800 backdrop-blur-md shadow-xl pointer-events-none"),i(S,"class","flex-1 min-h-[250px] bg-slate-950 rounded-xl border border-slate-800 shadow-inner relative overflow-hidden group mb-4"),i(e,"class","h-full flex flex-col")},m(N,le){R(N,e,le),s(e,l),s(l,n),s(l,o),s(l,c),s(c,r),s(r,f),s(c,u),s(c,h),s(h,p),s(c,y),s(c,g),s(g,C),s(e,v),s(e,S),s(S,k),t[18](k),s(S,W),s(S,w),D&&D.m(w,null),s(w,P),A&&A.m(w,null),M||(q=[$(r,"click",t[15]),$(h,"click",t[16]),$(g,"click",t[17])],M=!0)},p(N,le){le&2&&d!==(d=De(`px-3 py-1 rounded-md text-[10px] font-bold uppercase tracking-wide transition-all ${N[1]==="trajectory"?"bg-indigo-600 text-white shadow-sm":"text-slate-400 hover:text-white hover:bg-slate-700"}`)+" svelte-l1fefl")&&i(r,"class",d),le&2&&m!==(m=De(`px-3 py-1 rounded-md text-[10px] font-bold uppercase tracking-wide transition-all ${N[1]==="velocity"?"bg-indigo-600 text-white shadow-sm":"text-slate-400 hover:text-white hover:bg-slate-700"}`)+" svelte-l1fefl")&&i(h,"class",m),le&2&&b!==(b=De(`px-3 py-1 rounded-md text-[10px] font-bold uppercase tracking-wide transition-all ${N[1]==="combined"?"bg-indigo-600 text-white shadow-sm":"text-slate-400 hover:text-white hover:bg-slate-700"}`)+" svelte-l1fefl")&&i(g,"class",b),N[1]==="trajectory"||N[1]==="combined"?D||(D=Dl(),D.c(),D.m(w,P)):D&&(D.d(1),D=null),N[1]==="velocity"||N[1]==="combined"?A||(A=Il(),A.c(),A.m(w,null)):A&&(A.d(1),A=null)},d(N){N&&F(e),t[18](null),D&&D.d(),A&&A.d(),M=!1,Me(q)}}}function Dl(t){let e;return{c(){e=a("div"),e.innerHTML='<div class="w-2 h-2 rounded-full bg-emerald-400 shadow-[0_0_8px_rgba(52,211,153,0.6)]"></div> <span class="text-[10px] font-medium text-slate-300">Altezza</span>',i(e,"class","flex items-center gap-2 mb-2")},m(l,n){R(l,e,n)},d(l){l&&F(e)}}}function Il(t){let e;return{c(){e=a("div"),e.innerHTML='<div class="w-2 h-2 rounded-full bg-purple-400 shadow-[0_0_8px_rgba(167,139,250,0.6)]"></div> <span class="text-[10px] font-medium text-slate-300">Velocit</span>',i(e,"class","flex items-center gap-2")},m(l,n){R(l,e,n)},d(l){l&&F(e)}}}function ns(t){let e,l,n,o;const c=[ls,ts],r=[];function f(d,u){return d[4]==="summary"?0:1}return e=f(t),l=r[e]=c[e](t),{c(){l.c(),n=Tt()},m(d,u){r[e].m(d,u),R(d,n,u),o=!0},p(d,[u]){let h=e;e=f(d),e===h?r[e].p(d,u):(il(),We(r[h],1,1,()=>{r[h]=null}),ol(),l=r[e],l?l.p(d,u):(l=r[e]=c[e](d),l.c()),Ne(l,1),l.m(n.parentNode,n))},i(d){o||(Ne(l),o=!0)},o(d){We(l),o=!1},d(d){d&&F(n),r[e].d(d)}}}const Qe=5;function qt(t,e,l,n){t.clearRect(0,0,e,l),t.fillStyle=n,t.fillRect(0,0,e,l)}function Zt(t,{padding:e,width:l,height:n,chartWidth:o,chartHeight:c,minT:r,deltaT:f,minY:d,deltaY:u,style:h,xFormatter:p,yFormatter:m}){t.strokeStyle=h.grid,t.lineWidth=1,t.fillStyle=h.label,t.font="10px Inter",t.textAlign="right",t.textBaseline="middle";for(let g=0;g<=Qe;g++){const C=g/Qe,b=e+c*C,v=d+u*(Qe-g)/Qe;t.beginPath(),t.moveTo(e,b),t.lineTo(l-e,b),t.stroke(),t.fillText(m(v),e-8,b)}t.textAlign="center",t.textBaseline="top";const y=5;for(let g=0;g<=y;g++){const C=g/y,b=e+o*C,v=r+f*C;t.beginPath(),t.moveTo(b,e),t.lineTo(b,n-e),t.stroke(),t.fillText(p(v),b,n-e+8)}}function Kt(t,e,l,n,o,c,r){const f=(d,u,h)=>{if(d!=null&&u!=null){const p=o+(d-l)/n*c,m=o+(u-l)/n*c;t.fillStyle=h,t.fillRect(p,o,m-p,r)}};f(e.eccentricStart,e.eccentricEnd,"rgba(255, 165, 0, 0.1)"),f(e.concentricStart,e.concentricEnd,"rgba(74, 222, 128, 0.1)")}function Qt(t,e,l,n,o,c,r){const f=(d,u)=>{if(d==null)return;const h=o+(d-l)/n*c;t.strokeStyle=u,t.setLineDash([4,4]),t.beginPath(),t.moveTo(h,o),t.lineTo(h,r-o),t.stroke(),t.setLineDash([])};f(e.contactStart,"rgba(255, 255, 0, 0.6)"),f(e.eccentricEnd,"rgba(255, 165, 0, 0.6)"),f(e.takeoff,"rgba(255, 0, 0, 0.6)")}function ss(t,e,l){let n,o,c;ft(t,xt,I=>l(3,o=I)),ft(t,de,I=>l(22,c=I));let{results:r}=e;const f=Bt();let d="analysis",u="metrics",h="trajectory",p=null,m,y=[],g=null;const C={background:"#020617",grid:"#1e293b",line:"#4ade80",lineShadow:"rgba(74, 222, 128, 0.35)",label:"#94a3b8"},b={background:"#020617",grid:"#1e293b",line:"#a78bfa",lineShadow:"rgba(167, 139, 250, 0.35)",label:"#a78bfa",zero:"#64748b"};function v(){if(!m||c.trajectoryData.length===0)return;const I=window.devicePixelRatio||1,U=m.getBoundingClientRect();l(2,m.width=U.width*I,m),l(2,m.height=U.height*I,m);const T=m.getContext("2d");T.scale(I,I);const E=U.width,j=U.height,V=40,J=E-2*V,Y=j-2*V;qt(T,E,j,C.background);const Q=c.trajectoryData,oe=Math.max(...Q.map(z=>z.t)),x=Math.min(...Q.map(z=>z.t)),H=Math.max(...Q.map(z=>z.y)),L=Math.min(...Q.map(z=>z.y)),B=oe===x?1:oe-x,ne=H===L?1:H-L;Zt(T,{padding:V,width:E,height:j,chartWidth:J,chartHeight:Y,minT:x,deltaT:B,minY:L,deltaY:ne,style:C,xFormatter:z=>z.toFixed(2),yFormatter:z=>z.toFixed(0)}),g&&Kt(T,g,x,B,V,J,Y),T.lineWidth=3,T.strokeStyle=C.line,T.lineJoin="round",T.lineCap="round",T.shadowColor=C.lineShadow,T.shadowBlur=10,T.beginPath(),Q.forEach((z,Z)=>{const ue=V+(z.t-x)/B*J,G=j-V-(z.y-L)/ne*Y;Z===0?T.moveTo(ue,G):T.lineTo(ue,G)}),T.stroke(),T.shadowBlur=0,g&&Qt(T,g,x,B,V,J,j)}function S(){if(!m||y.length===0)return;const I=window.devicePixelRatio||1,U=m.getBoundingClientRect();l(2,m.width=U.width*I,m),l(2,m.height=U.height*I,m);const T=m.getContext("2d");T.scale(I,I);const E=U.width,j=U.height,V=40,J=E-2*V,Y=j-2*V;qt(T,E,j,b.background);const Q=y,oe=Math.max(...Q.map(z=>z.t)),x=Math.min(...Q.map(z=>z.t)),H=Math.max(...Q.map(z=>z.v)),L=Math.min(...Q.map(z=>z.v)),B=oe===x?1:oe-x,ne=H===L?Math.abs(H)||1:H-L;if(Zt(T,{padding:V,width:E,height:j,chartWidth:J,chartHeight:Y,minT:x,deltaT:B,minY:L,deltaY:ne,style:b,xFormatter:z=>z.toFixed(2),yFormatter:z=>z.toFixed(0)}),L<=0&&H>=0){const z=j-V-(0-L)/ne*Y;T.strokeStyle=b.zero,T.setLineDash([5,5]),T.beginPath(),T.moveTo(V,z),T.lineTo(E-V,z),T.stroke(),T.setLineDash([])}g&&Kt(T,g,x,B,V,J,Y),T.lineWidth=3,T.strokeStyle=b.line,T.lineJoin="round",T.shadowColor=b.lineShadow,T.shadowBlur=10,T.beginPath(),Q.forEach((z,Z)=>{const ue=V+(z.t-x)/B*J,G=j-V-(z.v-L)/ne*Y;Z===0?T.moveTo(ue,G):T.lineTo(ue,G)}),T.stroke(),T.shadowBlur=0,g&&Qt(T,g,x,B,V,J,j)}function k(){var Xe;if(!m)return;const I=c.trajectoryData,U=y;if(I.length===0||U.length===0)return;const T=window.devicePixelRatio||1,E=m.getBoundingClientRect();l(2,m.width=E.width*T,m),l(2,m.height=E.height*T,m);const j=m.getContext("2d");j.scale(T,T);const V=E.width,J=E.height,Y=40,Q=V-2*Y,oe=J-2*Y;qt(j,V,J,C.background);const x=((Xe=I[0])==null?void 0:Xe.y)||0,H=I.map(X=>({...X,y:X.y-x}));let L=Math.max(0,...H.map(X=>X.y)),B=Math.min(0,...H.map(X=>X.y)),ne=Math.max(0,...U.map(X=>X.v)),z=Math.min(0,...U.map(X=>X.v));const Z=L-B||1,ue=ne-z||1,G=Math.abs(B)/Z,se=Math.abs(z)/ue,pe=Math.max(G,se);let he=B,Ve=L,xe=z,Fe=ne;G<pe&&(he=-(pe*L)/(1-pe)),se<pe&&(xe=-(pe*ne)/(1-pe));const Ce=Ve-he||1,Ie=Fe-xe||1,Ee=Math.max(...I.map(X=>X.t),...U.map(X=>X.t)),ye=Math.min(...I.map(X=>X.t),...U.map(X=>X.t)),Se=Ee-ye||1;Zt(j,{padding:Y,width:V,height:J,chartWidth:Q,chartHeight:oe,minT:ye,deltaT:Se,minY:he,deltaY:Ce,style:C,xFormatter:X=>X.toFixed(2),yFormatter:X=>X.toFixed(0)});const Re=J-Y-(0-he)/Ce*oe;Re>=Y&&Re<=J-Y&&(j.strokeStyle="#64748b",j.setLineDash([4,4]),j.lineWidth=1.5,j.beginPath(),j.moveTo(Y,Re),j.lineTo(V-Y,Re),j.stroke(),j.setLineDash([])),g&&Kt(j,g,ye,Se,Y,Q,oe),j.lineWidth=3,j.strokeStyle=C.line,j.lineJoin="round",j.shadowColor=C.lineShadow,j.shadowBlur=10,j.beginPath(),H.forEach((X,me)=>{const ce=Y+(X.t-ye)/Se*Q,ge=J-Y-(X.y-he)/Ce*oe;me===0?j.moveTo(ce,ge):j.lineTo(ce,ge)}),j.stroke(),j.shadowBlur=0,j.lineWidth=3,j.strokeStyle=b.line,j.shadowColor=b.lineShadow,j.shadowBlur=10,j.beginPath(),U.forEach((X,me)=>{const ce=Y+(X.t-ye)/Se*Q,ge=J-Y-(X.v-xe)/Ie*oe;me===0?j.moveTo(ce,ge):j.lineTo(ce,ge)}),j.stroke(),j.shadowBlur=0,j.fillStyle=b.label,j.textAlign="left",j.textBaseline="middle";for(let X=0;X<=Qe;X++){const me=X/Qe,ce=Y+oe*me,ge=xe+Ie*(Qe-X)/Qe;j.fillText(ge.toFixed(0),V-Y+8,ce)}g&&Qt(j,g,ye,Se,Y,Q,J)}function W(){l(4,d="summary")}function w(){l(4,d="analysis")}function P(){f("exitNoSave")}function M(){f("uploadComplete")}const q=()=>l(0,u="metrics"),D=()=>l(0,u="charts"),A=()=>l(1,h="trajectory"),N=()=>l(1,h="velocity"),le=()=>l(1,h="combined");function ae(I){it[I?"unshift":"push"](()=>{m=I,l(2,m)})}const ee=()=>f("reset");return t.$$set=I=>{"results"in I&&l(11,r=I.results)},t.$$.update=()=>{if(t.$$.dirty&6152&&r){const I=r.id??r.timestamp??`${r.max_height||0}_${r.flight_time||0}`;I!==p&&(o.jumps.some(E=>{if(E.id&&r.id&&E.id===r.id)return!0;const j=E.max_height===r.max_height&&E.flight_time===r.flight_time,V=E.timestamp!=null&&r.timestamp!=null,J=V&&Math.abs(E.timestamp-r.timestamp)<1e3;return j&&(J||!V)})||pn(r),l(12,p=I))}t.$$.dirty&2048&&r&&(y=r.velocity||[],g=r.phase_times||null,r.trajectory&&ql(de,c.trajectoryData=r.trajectory,c)),t.$$.dirty&7&&u==="charts"&&m&&setTimeout(()=>{h==="trajectory"?v():h==="velocity"?S():h==="combined"&&k()},50),t.$$.dirty&2056&&l(5,n=o.jumps[o.currentJumpIndex]||r||{})},[u,h,m,o,d,n,f,W,w,P,M,r,p,q,D,A,N,le,ae,ee]}class is extends vt{constructor(e){super(),_t(this,e,ss,ns,nt,{results:11})}}function os(t){let e,l;return e=new is({props:{results:t[2]}}),e.$on("reset",t[5]),e.$on("exitNoSave",t[5]),e.$on("uploadComplete",t[5]),{c(){Et(e.$$.fragment)},m(n,o){gt(e,n,o),l=!0},p(n,o){const c={};o&4&&(c.results=n[2]),e.$set(c)},i(n){l||(Ne(e.$$.fragment,n),l=!0)},o(n){We(e.$$.fragment,n),l=!1},d(n){bt(e,n)}}}function as(t){let e,l;return e=new Yn({props:{currentStep:t[0]}}),e.$on("stepComplete",t[3]),e.$on("goBack",t[6]),e.$on("cancelToStep1",t[7]),{c(){Et(e.$$.fragment)},m(n,o){gt(e,n,o),l=!0},p(n,o){const c={};o&1&&(c.currentStep=n[0]),e.$set(c)},i(n){l||(Ne(e.$$.fragment,n),l=!0)},o(n){We(e.$$.fragment,n),l=!1},d(n){bt(e,n)}}}function rs(t){let e,l,n,o,c,r,f,d,u,h,p,m,y,g,C,b,v,S,k;m=new Cn({props:{analysisCompleted:t[1]}});const W=[as,os],w=[];function P(M,q){return M[1]?1:0}return C=P(t),b=w[C]=W[C](t),{c(){e=a("main"),l=a("header"),n=a("div"),n.innerHTML=`<div class="bg-indigo-600 p-1.5 rounded-md shadow-lg shadow-indigo-500/20"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-white"><path d="M22 12h-4l-3 9L9 3l-3 9H2"></path></svg></div>
      JumpAnalyzer <span class="text-[10px] bg-slate-800 px-1.5 py-0.5 rounded text-slate-400 font-medium border border-slate-700">PRO BETA</span>`,o=_(),c=a("div"),r=a("button"),r.textContent="Chiudi",f=_(),d=a("div"),u=_(),h=a("div"),p=a("div"),Et(m.$$.fragment),y=_(),g=a("div"),b.c(),i(n,"class","font-bold text-lg text-white tracking-tight flex items-center gap-2"),i(r,"class","text-xs font-medium text-red-400 hover:text-red-300 border border-red-900/30 bg-red-900/10 px-3 py-1.5 rounded hover:bg-red-900/20 transition-colors"),i(d,"class","w-8 h-8 rounded-full bg-gradient-to-tr from-indigo-500 to-purple-500 border-2 border-slate-800 cursor-pointer"),i(c,"class","flex items-center gap-4"),i(l,"class","h-14 bg-slate-900 border-b border-slate-800 flex items-center px-6 shrink-0 justify-between shadow-sm z-20"),i(p,"class","lg:col-span-8 flex flex-col h-full overflow-hidden"),i(g,"class","lg:col-span-4 flex flex-col h-full overflow-hidden"),i(h,"class","flex-1 p-4 grid grid-cols-1 lg:grid-cols-12 gap-4 overflow-hidden max-w-[1800px] mx-auto w-full"),i(e,"class","h-screen bg-slate-950 text-slate-200 font-sans flex flex-col overflow-hidden selection:bg-indigo-500/30")},m(M,q){R(M,e,q),s(e,l),s(l,n),s(l,o),s(l,c),s(c,r),s(c,f),s(c,d),s(e,u),s(e,h),s(h,p),gt(m,p,null),s(h,y),s(h,g),w[C].m(g,null),v=!0,S||(k=$(r,"click",t[4]),S=!0)},p(M,[q]){const D={};q&2&&(D.analysisCompleted=M[1]),m.$set(D);let A=C;C=P(M),C===A?w[C].p(M,q):(il(),We(w[A],1,1,()=>{w[A]=null}),ol(),b=w[C],b?b.p(M,q):(b=w[C]=W[C](M),b.c()),Ne(b,1),b.m(g,null))},i(M){v||(Ne(m.$$.fragment,M),Ne(b),v=!0)},o(M){We(m.$$.fragment,M),We(b),v=!1},d(M){M&&F(e),bt(m),w[C].d(),S=!1,k()}}}let cs=500;function ds(t,e,l){let n;ft(t,de,v=>l(11,n=v));let o=1,c=!1,r=null,f,d=150,u=0;async function h(){if(!(!n.isAnalyzing&&!n.isRecording&&!n.isCalibrating))try{if(n.isAnalyzing||n.isRecording||n.isCalibrating){const v=await fetch(`${Be()}/api/video/frame`,{signal:AbortSignal.timeout(1e3)});if(v.ok){const S=await v.json();S.success&&S.frame&&rl(S.frame)}}if(n.isAnalyzing){const v=await fetch(`${Be()}/api/analysis/data`,{signal:AbortSignal.timeout(1e3)});if(v.ok){const S=await v.json();S.realtime&&dn(S.realtime,S.trajectory,S.velocity)}}u>0&&(u=Math.max(0,u-1),l(9,d=Math.max(150,d-50)))}catch{u++,u>3&&l(9,d=Math.min(cs,d+50))}}nl(()=>{l(8,f=setInterval(h,d))}),en(()=>{f&&clearInterval(f)});function p(v){const{step:S,data:k}=v.detail;S===1?l(0,o=2):S===2?l(0,o=3):S===3&&(l(2,r=k),l(1,c=!0))}async function m(){const v=[];n.isAnalyzing&&v.push(fetch(`${Be()}/api/analysis/stop`,{method:"POST"}).catch(()=>{})),n.isRecording&&v.push(fetch(`${Be()}/api/recording/stop`,{method:"POST"}).catch(()=>{})),await Promise.all(v)}async function y(){var v,S;await m();try{(S=(v=n.previewStream)==null?void 0:v.getTracks())==null||S.forEach(k=>k.stop())}catch{}Wt(),de.set({isAnalyzing:!1,isRecording:!1,isCalibrating:!1,isPaused:!1,isCameraPreview:!1,inputMode:"none",videoFrame:null,realtimeData:{},trajectoryData:[],velocityData:[],localVideoUrl:null});try{window.close()}catch{}}function g(v=!1){l(1,c=!1),l(2,r=null),l(0,o=1),u=0,l(9,d=150),de.update(S=>({isAnalyzing:!1,isRecording:!1,isCalibrating:!1,isPaused:!1,isCameraPreview:!1,inputMode:v?S.inputMode:"none",videoFrame:null,realtimeData:{},trajectoryData:[],velocityData:[],localVideoUrl:v?S.localVideoUrl:null}))}async function C(){o>1&&(await m(),l(0,o--,o))}async function b(){await m(),l(0,o=1),g(!0)}return t.$$.update=()=>{t.$$.dirty&768&&f&&(clearInterval(f),l(8,f=setInterval(h,d)))},[o,c,r,p,y,g,C,b,f,d]}class us extends vt{constructor(e){super(),_t(this,e,ds,rs,nt,{})}}window.__APP_LOADING__=!0;function Ll(){try{const t=document.getElementById("app");if(!t)throw new Error("Elemento #app non trovato nel DOM");t.innerHTML="";const e=new us({target:t});window.__APP_LOADED__=!0,window.__APP_LOADING__=!1}catch(t){console.error("Errore durante l'inizializzazione dell'app:",t),window.__APP_LOADING__=!1;const e=document.getElementById("app");e&&(e.innerHTML=`
        <div style="display: flex; align-items: center; justify-content: center; height: 100vh; background: #0f172a; color: white; font-family: sans-serif; padding: 20px;">
          <div style="text-align: center; max-width: 600px;">
            <h1 style="color: #ef4444; margin-bottom: 20px;">Errore di Caricamento</h1>
            <p style="color: #94a3b8; margin-bottom: 10px;">Si  verificato un errore durante il caricamento dell'applicazione.</p>
            <p style="color: #64748b; font-size: 14px; margin-top: 20px; word-break: break-word;">${t.message||"Errore sconosciuto"}</p>
            <p style="color: #64748b; font-size: 12px; margin-top: 10px;">Stack: ${t.stack||"N/A"}</p>
            <p style="color: #64748b; font-size: 12px; margin-top: 10px;">Apri la console del browser (F12) per maggiori dettagli.</p>
          </div>
        </div>
      `)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Ll):Ll()})();
